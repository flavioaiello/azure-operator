[
{
    "name": "Audit-TrustedLaunch",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Audit virtual machines for Trusted Launch support",
        "description": "Trusted Launch improves security of a Virtual Machine which requires VM SKU, OS Disk & OS Image to support it (Gen 2). To learn more about Trusted Launch, visit https://aka.ms/trustedlaunch.",
        "metadata": {
            "version": "1.1.0",
            "category": "Trusted Launch",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
              ]
        },
        "version": "1.0.0",
        "parameters": {
            "effect": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "AuditDisksOsTrustedLaunch",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b03bb370-5249-4ea4-9fce-2552e87e45fa",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AuditTrustedLaunchEnabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c95b54ad-0614-4633-ab29-104b01235cbf",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    }
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Audit-UnusedResourcesCostOptimization",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Unused resources driving cost should be avoided",
        "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Azure Policy Initiative as a cost control tool to reveal orphaned resources that are contributing cost.",
        "metadata": {
            "version": "2.1.0",
            "category": "Cost Optimization",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
              ]
        },
        "parameters": {
            "effectDisks": {
                "type": "String",
                "metadata": {
                    "displayName": "Disks Effect",
                    "description": "Enable or disable the execution of the policy for Microsoft.Compute/disks"
                },
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "effectPublicIpAddresses": {
                "type": "String",
                "metadata": {
                    "displayName": "PublicIpAddresses Effect",
                    "description": "Enable or disable the execution of the policy for Microsoft.Network/publicIpAddresses"
                },
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "effectServerFarms": {
                "type": "String",
                "metadata": {
                    "displayName": "ServerFarms Effect",
                    "description": "Enable or disable the execution of the policy for Microsoft.Web/serverfarms"
                },
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "AuditDisksUnusedResourcesCostOptimization",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectDisks')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AuditPublicIpAddressesUnusedResourcesCostOptimization",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectPublicIpAddresses')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AuditServerFarmsUnusedResourcesCostOptimization",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectServerFarms')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AuditAzureHybridBenefitUnusedResourcesCostOptimization",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "Audit"
                    }
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Deny-PublicPaaSEndpoints",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Public network access should be disabled for PaaS services",
        "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
        "metadata": {
            "version": "5.2.0",
            "category": "Network",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud"
            ]
        },
        "parameters": {
            "CosmosPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for CosmosDB",
                    "description": "This policy denies that Cosmos database accounts  are created with out public network access is disabled."
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "KeyVaultPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for KeyVault",
                    "description": "This policy denies creation of Key Vaults with IP Firewall exposed to all public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "SqlServerPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access on Azure SQL Database should be disabled",
                    "description": "This policy denies creation of Sql servers with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "StoragePublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access onStorage accounts should be disabled",
                    "description": "This policy denies creation of storage accounts with IP Firewall exposed to all public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "AKSPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access on AKS API should be disabled",
                    "description": "This policy denies  the creation of  Azure Kubernetes Service non-private clusters"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "ACRPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access on Azure Container Registry disabled",
                    "description": "This policy denies the creation of Azure Container Registries with exposed public endpoints "
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "AFSPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access on Azure File Sync disabled",
                    "description": "This policy denies the creation of Azure File Sync instances with exposed public endpoints "
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "PostgreSQLFlexPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for PostgreSql Flexible Server",
                    "description": "This policy denies creation of PostgreSQL Flexible DB accounts with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "postgreSqlPublicNetworkAccess": {
                "type": "string",
                "metadata": {
                    "displayName": "Public network access should be disabled for PostgreSQL servers",
                    "description": "This policy denies creation of PostgreSQL DB accounts with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "MySQLFlexPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for MySQL Flexible Server",
                    "description": "This policy denies creation of MySql Flexible Server DB accounts with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "BatchPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for Azure Batch Instances",
                    "description": "This policy denies creation of Azure Batch Instances with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "MariaDbPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for Azure MariaDB",
                    "description": "This policy denies creation of Azure MariaDB with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "MlPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for Azure Machine Learning",
                    "description": "This policy denies creation of Azure Machine Learning with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "RedisCachePublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for Azure Cache for Redis",
                    "description": "This policy denies creation of Azure Cache for Redis with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "BotServicePublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for Bot Service",
                    "description": "This policy denies creation of Bot Service with exposed public endpoints. Bots should be set to 'isolated only' mode"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "AutomationPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for Automation accounts",
                    "description": "This policy denies creation of Automation accounts with exposed public endpoints. Bots should be set to 'isolated only' mode"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "AppConfigPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for App Configuration",
                    "description": "This policy denies creation of App Configuration with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "FunctionPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for Function apps",
                    "description": "This policy denies creation of Function apps with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "FunctionAppSlotPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for Function apps",
                    "description": "This policy denies creation of Function apps with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "AsePublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for App Service Environment apps",
                    "description": "This policy denies creation of App Service Environment apps with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "AsPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for App Service apps",
                    "description": "This policy denies creation of App Service apps with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "ApiManPublicIpDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Public network access should be disabled for API Management services",
                    "description": "This policy denies creation of API Management services with exposed public endpoints"
                },
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "AuditIfNotExists"
            },
            "ContainerAppsEnvironmentDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Container Apps environment should disable public network access",
                    "description": "This policy denies creation of Container Apps Environment with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "AsrVaultDenyEffect": {
                "type": "String",
                "metadata": {
                    "displayName": "Azure Recovery Services vaults should disable public network access",
                    "description": "This policy denies creation of Azure Recovery Services vaults with exposed public endpoints"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "logicAppPublicNetworkAccessEffect": {
                "type": "String",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "appSlotsPublicNetworkAccess": {
                "type": "string",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "cognitiveSearchPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "managedDiskPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "containerAppsPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adxPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adfPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventGridPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventGridTopicPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventHubNamespacesPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultManagedHsmDisablePublicNetwork": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "mySqlPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveServicesNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveServicesPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "serviceBusDisablePublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "sqlManagedPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsPublicAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "synapsePublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "avdHostPoolPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "avdWorkspacePublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "grafanaPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "CosmosDenyPaasPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('CosmosPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "KeyVaultDenyPaasPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('KeyVaultPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SqlServerDenyPaasPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SqlServerPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "StorageDenyPaasPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b2982f36-99f2-4db5-8eff-283140c09693",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('StoragePublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AKSDenyPaasPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AKSPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "ACRDenyPaasPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('ACRPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AFSDenyPaasPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AFSPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "PostgreSQLFlexDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
                "definitionVersion": "3.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('PostgreSQLFlexPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "Deny-PostgreSql-Public-Network-Access",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('postgreSqlPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionReferenceId": "MySQLFlexDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('MySQLFlexPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "BatchDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('BatchPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "MariaDbDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('MariaDbPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "MlDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('MlPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "RedisCacheDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('RedisCachePublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "BotServiceDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e8168db-69e3-4beb-9822-57cb59202a9d",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('BotServicePublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AutomationDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AutomationPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AppConfigDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3d9f5e4c-9947-4579-9539-2a7695fbc187",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AppConfigPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "FunctionDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/969ac98b-88a8-449f-883c-2e9adb123127",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('FunctionPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "FunctionAppSlotsDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/11c82d0c-db9f-4d7b-97c5-f3f9aa957da2",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('FunctionAppSlotPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AseDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
                "definitionVersion": "3.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AsePublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AsDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AsPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "ApiManDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('ApiManPublicIpDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "ContainerAppsEnvironmentDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d074ddf8-01a5-4b5e-a2b8-964aed452c0a",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('ContainerAppsEnvironmentDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/783ea2a8-b8fd-46be-896a-9ae79643a0b1",
                "policyDefinitionReferenceId": "Deny-ContainerApps-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerAppsPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionReferenceId": "AsrVaultDenyPublicIP",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9ebbbba3-4d65-4da9-bb67-b22cfaaff090",
                "definitionVersion": "1.*.*-preview",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AsrVaultDenyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "Deny-LogicApp-Public-Network-Access",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApp-Public-Network",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('logicAppPublicNetworkAccessEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/701a595d-38fb-4a66-ae6d-fb3735217622",
                "policyDefinitionReferenceId": "Deny-AppSlots-Public",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appSlotsPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee980b6d-0eca-4501-8d54-f6290fd512c3",
                "policyDefinitionReferenceId": "Deny-CognitiveSearch-PublicEndpoint",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveSearchPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8405fdab-1faf-48aa-b702-999c9c172094",
                "policyDefinitionReferenceId": "Deny-ManagedDisk-Public-Network-Access",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('managedDiskPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/43bc7be6-5e69-4b0d-a2bb-e815557ca673",
                "policyDefinitionReferenceId": "Deny-ADX-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adxPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1cf164be-6819-4a50-b8fa-4bcaa4f98fb6",
                "policyDefinitionReferenceId": "Deny-Adf-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adfPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8f774be-6aee-492a-9e29-486ef81f3a68",
                "policyDefinitionReferenceId": "Deny-EventGrid-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1adadefe-5f21-44f7-b931-a59b54ccdb45",
                "policyDefinitionReferenceId": "Deny-EventGrid-Topic-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridTopicPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0602787f-9896-402a-a6e1-39ee63ee435e",
                "policyDefinitionReferenceId": "Deny-EH-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubNamespacesPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f",
                "policyDefinitionReferenceId": "Deny-KV-Hms-PublicNetwork",
                "definitionVersion": "1.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultManagedHsmDisablePublicNetwork')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
                "policyDefinitionReferenceId": "Deny-MySql-Public-Network-Access",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mySqlPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0725b4dd-7e76-479c-a735-68e7ee23d5ca",
                "policyDefinitionReferenceId": "Deny-Cognitive-Services-Public-Network-Access",
                "definitionVersion": "3.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
                "policyDefinitionReferenceId": "Deny-Cognitive-Services-Network-Access",
                "definitionVersion": "3.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cbd11fd3-3002-4907-b6c8-579f0e700e13",
                "policyDefinitionReferenceId": "Deny-Sb-PublicEndpoint",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('serviceBusDisablePublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
                "policyDefinitionReferenceId": "Deny-Sql-Managed-Public-Endpoint",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('sqlManagedPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
                "policyDefinitionReferenceId": "Deny-Storage-Public-Access",
                "definitionVersion": "3.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsPublicAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/38d8df46-cf4e-4073-8e03-48c24b29de0d",
                "policyDefinitionReferenceId": "Deny-Synapse-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapsePublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/87ac3038-c07a-4b92-860d-29e270a4f3cd",
                "policyDefinitionReferenceId": "Deny-Workspace-PublicNetworkAccess",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('avdWorkspacePublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c25dcf31-878f-4eba-98eb-0818fdc6a334",
                "policyDefinitionReferenceId": "Deny-Hostpool-PublicNetworkAccess",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('avdHostPoolPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e8775d5a-73b7-4977-a39b-833ef0114628",
                "policyDefinitionReferenceId": "Deny-Grafana-PublicNetworkAccess",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('grafanaPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "DenyAction-DeleteProtection",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "DenyAction Delete - Activity Log Settings and Diagnostic Settings",
        "description": "Enforces DenyAction - Delete on Activity Log Settings and Diagnostic Settings.",
        "metadata": {
            "version": "1.1.0",
            "category": "Monitoring",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {},
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "DenyActionDelete-DiagnosticSettings",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DiagnosticLogs",
                "definitionVersion": "1.*.*",
                "parameters": {},
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "DenyActionDelete-ActivityLogSettings",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/DenyAction-ActivityLogs",
                "definitionVersion": "1.*.*",
                "parameters": {},
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Deploy-AUM-CheckUpdates",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Configure periodic checking for missing system updates on azure virtual machines and Arc-enabled virtual machines",
        "description": "Configure auto-assessment (every 24 hours) for OS updates. You can control the scope of assignment according to machine subscription, resource group, location or tag. Learn more about this for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.",
        "metadata": {
            "version": "1.1.0",
            "category": "Security Center",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud"
            ]
        },
        "parameters": {
            "assessmentMode": {
                "type": "String",
                "metadata": {
                    "displayName": "Assessment mode",
                    "description": "Assessment mode for the machines."
                },
                "allowedValues": [
                    "ImageDefault",
                    "AutomaticByPlatform"
                ],
                "defaultValue": "AutomaticByPlatform"
            },
            "locations": {
                "type": "Array",
                "metadata": {
                    "displayName": "Machines locations",
                    "description": "The list of locations from which machines need to be targeted.",
                    "strongType": "location"
                },
                "defaultValue": []
            },
            "tagValues": {
                "type": "Object",
                "metadata": {
                    "displayName": "Tags on machines",
                    "description": "The list of tags that need to matched for getting target machines."
                },
                "defaultValue": {}
            },
            "tagOperator": {
                "type": "String",
                "metadata": {
                    "displayName": "Tag operator",
                    "description": "Matching condition for resource tags"
                },
                "allowedValues": [
                    "All",
                    "Any"
                ],
                "defaultValue": "Any"
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "azureUpdateManagerVmCheckUpdateWindows",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
                "definitionVersion": "4.*.*",
                "parameters": {
                    "assessmentMode": {
                        "value": "[[parameters('assessmentMode')]"
                    },
                    "osType": {
                        "value": "Windows"
                    },
                    "locations": {
                        "value": "[[parameters('locations')]"
                    },
                    "tagValues": {
                        "value": "[[parameters('tagValues')]"
                    },
                    "tagOperator": {
                        "value": "[[parameters('tagOperator')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "azureUpdateManagerVmCheckUpdateLinux",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
                "definitionVersion": "4.*.*",
                "parameters": {
                    "assessmentMode": {
                        "value": "[[parameters('assessmentMode')]"
                    },
                    "osType": {
                        "value": "Linux"
                    },
                    "locations": {
                        "value": "[[parameters('locations')]"
                    },
                    "tagValues": {
                        "value": "[[parameters('tagValues')]"
                    },
                    "tagOperator": {
                        "value": "[[parameters('tagOperator')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "azureUpdateManagerVmArcCheckUpdateWindows",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bfea026e-043f-4ff4-9d1b-bf301ca7ff46",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "assessmentMode": {
                        "value": "[[parameters('assessmentMode')]"
                    },
                    "osType": {
                        "value": "Windows"
                    },
                    "locations": {
                        "value": "[[parameters('locations')]"
                    },
                    "tagValues": {
                        "value": "[[parameters('tagValues')]"
                    },
                    "tagOperator": {
                        "value": "[[parameters('tagOperator')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "azureUpdateManagerVmArcCheckUpdateLinux",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bfea026e-043f-4ff4-9d1b-bf301ca7ff46",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "assessmentMode": {
                        "value": "[[parameters('assessmentMode')]"
                    },
                    "osType": {
                        "value": "Linux"
                    },
                    "locations": {
                        "value": "[[parameters('locations')]"
                    },
                    "tagValues": {
                        "value": "[[parameters('tagValues')]"
                    },
                    "tagOperator": {
                        "value": "[[parameters('tagOperator')]"
                    }
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
  "name": "Deploy-Diagnostics-LogAnalytics",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2021-06-01",
  "scope": null,
  "properties": {
    "policyType": "Custom",
    "displayName": "[Deprecated]: Deploy Diagnostic Settings to Azure Services",
    "description": "This policy set deploys the configurations of application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace. This policy set is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
    "metadata": {
      "deprecated": true,
      "version": "2.2.0-deprecated",
      "category": "Monitoring",
      "source": "https://github.com/Azure/Enterprise-Scale/",
      "alzCloudEnvironments": [
        "AzureCloud"
      ]
    },
    "parameters": {
      "logAnalytics": {
        "metadata": {
          "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
          "displayName": "Log Analytics workspace",
          "strongType": "omsWorkspace"
        },
        "type": "String"
      },
      "profileName": {
        "type": "String",
        "defaultValue": "setbypolicy",
        "metadata": {
          "displayName": "Profile name",
          "description": "The diagnostic settings profile name"
        }
      },
      "ACILogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Container Instances to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled."
        }
      },
      "ACRLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Container Registry to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled."
        }
      },
      "AKSLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Kubernetes Service to stream to a Log Analytics workspace when any Kubernetes Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled."
        }
      },
      "AnalysisServiceLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "APIforFHIRLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "APIMgmtLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for API Management to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "APIMgmtLogAnalyticsDestinationType": {
        "type": "String",
        "defaultValue": "AzureDiagnostics",
        "allowedValues": [
          "AzureDiagnostics",
          "Dedicated"
        ],
        "metadata": {
          "displayName": "Destination table for the Diagnostic Setting for API Management to Log Analytics workspace",
          "description": "Destination table for the diagnostic setting for API Management to Log Analytics workspace, allowed values are 'Dedicated' (for resource-specific) and 'AzureDiagnostics'. Default value is 'AzureDiagnostics'"
        }
      },
      "ApplicationGatewayLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "AutomationLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Automation to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "BastionLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "BatchLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Batch to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Batch to stream to a Log Analytics workspace when any Batch which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "CDNEndpointsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "CognitiveServicesLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "CosmosLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "DatabricksLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Databricks to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "DataExplorerClusterLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "DataFactoryLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Data Factory to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "DataLakeStoreLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Azure Data Lake Store to stream to a Log Analytics workspace when anyAzure Data Lake Store which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "DataLakeAnalyticsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "EventGridSubLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "EventGridTopicLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "EventHubLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Event Hubs to stream to a Log Analytics workspace when any Event Hubs which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "EventSystemTopicLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "ExpressRouteLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "FirewallLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Firewall to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "FirewallLogAnalyticsDestinationType": {
        "type": "String",
        "defaultValue": "AzureDiagnostics",
        "allowedValues": [
          "AzureDiagnostics",
          "Dedicated"
        ],
        "metadata": {
          "displayName": "Destination table for the Diagnostic Setting for Firewall to Log Analytics workspace",
          "description": "Destination table for the diagnostic setting for Firewall to Log Analytics workspace, allowed values are 'Dedicated' (for resource-specific) and 'AzureDiagnostics'. Default value is 'AzureDiagnostics'"
        }
      },
      "FrontDoorLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Front Door to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "FunctionAppLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "HDInsightLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for HDInsight to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "IotHubLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "KeyVaultLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Key Vault to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Key Vault to stream to a Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "LoadBalancerLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "LogAnalyticsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Log Analytics to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category Audit enabled"
        }
      },
      "LogicAppsISELogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "LogicAppsWFLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Logic Apps Workflows to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Logic Apps Workflows to stream to a Log Analytics workspace when any Logic Apps Workflows which are missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "MariaDBLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for MariaDB to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "MediaServiceLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "MlWorkspaceLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "MySQLLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "NetworkSecurityGroupsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "NetworkNICLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "PostgreSQLLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "PowerBIEmbeddedLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "NetworkPublicIPNicLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Public IP addresses to stream to a Log Analytics workspace when any Public IP addresses which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "RedisCacheLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "RelayLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Relay to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "SearchServicesLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Search Services to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Search Services to stream to a Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "ServiceBusLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for ServiceBus to stream to a Log Analytics workspace when any ServiceBus which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "SignalRLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for SignalR to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "SQLDBsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for SQL Databases to stream to a Log Analytics workspace when any SQL Databases  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "SQLElasticPoolsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "SQLMLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "StreamAnalyticsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Stream Analytics to stream to a Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "TimeSeriesInsightsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "TrafficManagerLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "VirtualNetworkLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "VirtualMachinesLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "VMSSLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "VNetGWLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled."
        }
      },
      "AppServiceLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "AppServiceWebappLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for App Service to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "AVDScalingPlansLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "WVDAppGroupsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for AVD Application Groups to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for AVD Application groups to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "WVDWorkspaceLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "WVDHostPoolsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for AVD Host pools to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for AVD Host pools to stream to a Log Analytics workspace when any host pool which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "StorageAccountsLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for Storage Accounts to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for Storage Accounts to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      },
      "VWanS2SVPNGWLogAnalyticsEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy Diagnostic Settings for VWAN S2S VPN gateway to Log Analytics workspace",
          "description": "Deploys the diagnostic settings for VWAN S2S VPN gateway to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled"
        }
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "StorageAccountDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('StorageAccountsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "StorageAccountBlobServicesDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('StorageAccountsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "StorageAccountFileServicesDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('StorageAccountsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "StorageAccountQueueServicesDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('StorageAccountsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "StorageAccountTableServicesDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('StorageAccountsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AVDScalingPlansDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('AVDScalingPlansLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "WVDAppGroupDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('WVDAppGroupsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "WVDWorkspaceDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('WVDWorkspaceLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "WVDHostPoolsDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('WVDHostPoolsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ACIDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('ACILogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ACRDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('ACRLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AKSDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('AKSLogAnalyticsEffect')]"
          },
          "diagnosticsSettingNameToUse": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AnalysisServiceDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('AnalysisServiceLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "APIforFHIRDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('APIforFHIRLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "APIMgmtDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "logAnalyticsDestinationType": {
            "value": "[[parameters('APIMgmtLogAnalyticsDestinationType')]"
          },
          "effect": {
            "value": "[[parameters('APIMgmtLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ApplicationGatewayDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('ApplicationGatewayLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AutomationDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('AutomationLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "BastionDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('BastionLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "BatchDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('BatchLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "CDNEndpointsDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('CDNEndpointsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "CognitiveServicesDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('CognitiveServicesLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "CosmosDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('CosmosLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DatabricksDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('DatabricksLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DataExplorerClusterDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('DataExplorerClusterLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DataFactoryDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('DataFactoryLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DataLakeStoreDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('DataLakeStoreLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DataLakeAnalyticsDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('DataLakeAnalyticsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "EventGridSubDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('EventGridSubLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "EventGridTopicDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('EventGridTopicLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "EventHubDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('EventHubLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "EventSystemTopicDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('EventSystemTopicLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ExpressRouteDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('ExpressRouteLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "FirewallDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "logAnalyticsDestinationType": {
            "value": "[[parameters('FirewallLogAnalyticsDestinationType')]"
          },
          "effect": {
            "value": "[[parameters('FirewallLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "FrontDoorDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('FrontDoorLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "FunctionAppDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('FunctionAppLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "HDInsightDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('HDInsightLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "IotHubDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('IotHubLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "KeyVaultDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('KeyVaultLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "LoadBalancerDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('LoadBalancerLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "LogAnalyticsDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('LogAnalyticsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "LogicAppsISEDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('LogicAppsISELogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "LogicAppsWFDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('LogicAppsWFLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "MariaDBDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('MariaDBLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "MediaServiceDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('MediaServiceLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "MlWorkspaceDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('MlWorkspaceLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "MySQLDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('MySQLLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "NetworkSecurityGroupsDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('NetworkSecurityGroupsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "NetworkNICDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('NetworkNICLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PostgreSQLDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('PostgreSQLLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PowerBIEmbeddedDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('PowerBIEmbeddedLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "NetworkPublicIPNicDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('NetworkPublicIPNicLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          },
          "metricsEnabled": {
            "value": "True"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "RecoveryVaultDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "RedisCacheDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('RedisCacheLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "RelayDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('RelayLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SearchServicesDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('SearchServicesLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ServiceBusDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('ServiceBusLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SignalRDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('SignalRLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQLDatabaseDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('SQLDBsLogAnalyticsEffect')]"
          },
          "diagnosticsSettingNameToUse": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQLElasticPoolsDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('SQLElasticPoolsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQLMDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('SQLMLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "StreamAnalyticsDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('StreamAnalyticsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "TimeSeriesInsightsDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('TimeSeriesInsightsLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "TrafficManagerDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('TrafficManagerLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "VirtualNetworkDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('VirtualNetworkLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "VirtualMachinesDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('VirtualMachinesLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "VMSSDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('VMSSLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "VNetGWDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('VNetGWLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('AppServiceLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceWebappDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('AppServiceWebappLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "VWanS2SVPNGWDeployDiagnosticLogDeployLogAnalytics",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW",
        "parameters": {
          "logAnalytics": {
            "value": "[[parameters('logAnalytics')]"
          },
          "effect": {
            "value": "[[parameters('VWanS2SVPNGWLogAnalyticsEffect')]"
          },
          "profileName": {
            "value": "[[parameters('profileName')]"
          }
        },
        "groupNames": []
      }
    ],
    "policyDefinitionGroups": null
  }
}
,
{
    "name": "Deploy-MDFC-Config",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "[Deprecated]: Deploy Microsoft Defender for Cloud configuration",
        "description": "Deploy Microsoft Defender for Cloud configuration. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config_20240319.html",
        "metadata": {
            "version": "7.0.0-deprecated",
            "category": "Security Center",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "deprecated": true,
            "supersededBy": "Deploy-MDFC-Config_20240319",
            "alzCloudEnvironments": [
                "AzureCloud"
            ]
        },
        "parameters": {
            "emailSecurityContact": {
                "type": "string",
                "metadata": {
                    "displayName": "Security contacts email address",
                    "description": "Provide email address for Microsoft Defender for Cloud contact details"
                }
            },
            "minimalSeverity": {
                "type": "string",
                "allowedValues": [
                    "High",
                    "Medium",
                    "Low"
                ],
                "defaultValue": "High",
                "metadata": {
                    "displayName": "Minimal severity",
                    "description": "Defines the minimal alert severity which will be sent as email notifications"
                }
            },
            "logAnalytics": {
                "type": "String",
                "metadata": {
                    "displayName": "Primary Log Analytics workspace",
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "strongType": "omsWorkspace"
                }
            },
            "ascExportResourceGroupName": {
                "type": "String",
                "metadata": {
                    "displayName": "Resource Group name for the export to Log Analytics workspace configuration",
                    "description": "The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured."
                }
            },
            "ascExportResourceGroupLocation": {
                "type": "String",
                "metadata": {
                    "displayName": "Resource Group location for the export to Log Analytics workspace configuration",
                    "description": "The location where the resource group and the export to Log Analytics workspace configuration are created."
                }
            },
            "enableAscForCosmosDbs": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForSql": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForSqlOnVm": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForDns": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForArm": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForOssDb": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForAppServices": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForKeyVault": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForStorage": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForContainers": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForServers": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForServersVulnerabilityAssessments": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "vulnerabilityAssessmentProvider": {
                "type": "String",
                "allowedValues": [
                    "default",
                    "mdeTvm"
                ],
                "defaultValue": "default",
                "metadata": {
                    "displayName": "Vulnerability assessment provider type",
                    "description": "Select the vulnerability assessment solution to provision to machines."
                }
            },
            "enableAscForApis": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForCspm": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "defenderForOssDb",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForOssDb')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForVM",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForServers')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForVMVulnerabilityAssessment",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForServersVulnerabilityAssessments')]"
                    },
                    "vaType": {
                        "value": "[[parameters('vulnerabilityAssessmentProvider')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForSqlServerVirtualMachines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForSqlOnVm')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForAppServices",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForAppServices')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForStorageAccountsV2",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cfdc5972-75b3-4418-8ae1-7f5c36839390",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForStorage')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderforContainers",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForContainers')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderforKubernetes",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForContainers')]"
                    },
                    "logAnalyticsWorkspaceResourceId": {
                        "value": "[[parameters('logAnalytics')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "azurePolicyForKubernetes",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForContainers')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForKeyVaults",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForKeyVault')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForDns",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForDns')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForArm",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForArm')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForSqlPaas",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForSql')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForCosmosDbs",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForCosmosDbs')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForApis",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e54d2be9-5f2e-4d65-98e4-4f0e670b23d6",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForApis')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForCspm",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/689f7782-ef2c-4270-a6d0-7664869076bd",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForCspm')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "securityEmailContact",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                "parameters": {
                    "emailSecurityContact": {
                        "value": "[[parameters('emailSecurityContact')]"
                    },
                    "minimalSeverity": {
                        "value": "[[parameters('minimalSeverity')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "ascExport",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                "parameters": {
                    "resourceGroupName": {
                        "value": "[[parameters('ascExportResourceGroupName')]"
                    },
                    "resourceGroupLocation": {
                        "value": "[[parameters('ascExportResourceGroupLocation')]"
                    },
                    "workspaceResourceId": {
                        "value": "[[parameters('logAnalytics')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "migrateToMdeTvm",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/766e621d-ba95-4e43-a6f2-e945db3d7888",
                "parameters": {
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Deploy-MDFC-Config_20240319",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Deploy Microsoft Defender for Cloud configuration",
        "description": "Deploy Microsoft Defender for Cloud configuration",
        "metadata": {
            "version": "2.3.0",
            "category": "Security Center",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "replacesPolicy": "Deploy-MDFC-Config",
            "alzCloudEnvironments": [
                "AzureCloud"
            ]
        },
        "parameters": {
            "emailSecurityContact": {
                "type": "string",
                "metadata": {
                    "displayName": "Security contacts email address",
                    "description": "Provide email address for Microsoft Defender for Cloud contact details"
                }
            },
            "minimalSeverity": {
                "type": "string",
                "allowedValues": [
                    "High",
                    "Medium",
                    "Low"
                ],
                "defaultValue": "High",
                "metadata": {
                    "displayName": "Minimal severity",
                    "description": "Defines the minimal alert severity which will be sent as email notifications"
                }
            },
            "logAnalytics": {
                "type": "String",
                "metadata": {
                    "displayName": "Primary Log Analytics workspace",
                    "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                    "strongType": "omsWorkspace"
                }
            },
            "ascExportResourceGroupName": {
                "type": "String",
                "metadata": {
                    "displayName": "Resource Group name for the export to Log Analytics workspace configuration",
                    "description": "The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured."
                }
            },
            "ascExportResourceGroupLocation": {
                "type": "String",
                "metadata": {
                    "displayName": "Resource Group location for the export to Log Analytics workspace configuration",
                    "description": "The location where the resource group and the export to Log Analytics workspace configuration are created."
                }
            },
            "createResourceGroup":{
                "type": "Boolean",
                "metadata": {
                    "displayName": "Create resource group",
                    "description": "If a resource group does not exists in the scope, a new resource group will be created. If the resource group exists and this flag is set to 'true' the policy will re-deploy the resource group. Please note this will reset any Azure Tag on the resource group."
                },
                "defaultValue": true,
                "allowedValues": [
                    true,
                    false
                ]
            },
            "enableAscForCosmosDbs": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForSql": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForSqlOnVm": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForArm": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "ascForArmSubPlan": {
                "type": "String",
                "metadata": {
                    "displayName": "Defender for Resource Manager plans",
                    "description": "Select a Defender for Resource Manager plan"
                },
                "allowedValues": [
                    "PerSubscription",
                    "PerApiCall"
                ],
                "defaultValue": "PerApiCall"
            },
            "enableAscForOssDb": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForAppServices": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForKeyVault": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "ascForKeyVaultSubPlan": {
                "type": "String",
                "metadata": {
                    "displayName": "Key Vaults bundle's sub plan",
                    "description": "Select a Defender for Key Vault plan"
                },
                "allowedValues": [
                    "PerTransaction",
                    "PerKeyVault"
                ],
                "defaultValue": "PerTransaction"
            },
            "enableAscForStorage": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "ascForStorageIsOnUploadMalwareScanningEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Malware Scanning Enabled",
                    "description": "Enable or disable the Malware Scanning add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "ascForStorageCapGBPerMonthPerStorageAccount": {
                "type": "Integer",
                "metadata": {
                    "displayName": "Cap GB Per Month Per Storage Account",
                    "description": "Limit the GB scanned per month for each storage account within the subscription. Value must be an integer, 10GB or higher. Set to -1 for unlimited scanning"
                },
                "defaultValue": 5000
            },
            "ascForStorageIsSensitiveDataDiscoveryEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Sensitive Data Threat Detection Enabled",
                    "description": "Enable or disable the Sensitive Data Threat Detection add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "enableAscForContainers": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "enableAscForAI": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "ascForAIIsAIPromptEvidenceEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "AI Prompt Evidence Enabled",
                    "description": "Enable or disable the AI Prompt Evidence add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "enableAscForServers": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "ascForServersSubPlan": {
                "type": "String",
                "metadata": {
                    "displayName": "Defender for Servers plans",
                    "description": "Select a Defender for Servers plan"
                },
                "allowedValues": [
                    "P1",
                    "P2"
                ],
                "defaultValue": "P2"
            },
            "ascForServersIsAgentlessVmScanningEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Agentless VM Scanning Enabled",
                    "description": "Enable or disable the Agentless VM Scanning add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "ascForServersIsMdeDesignatedSubscriptionEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "MDE Designated Subscription Enabled",
                    "description": "Enable or disable the MDE Designated Subscription add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "false"
            },
            "enableAscForServersVulnerabilityAssessments": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "vulnerabilityAssessmentProvider": {
                "type": "String",
                "allowedValues": [
                    "default",
                    "mdeTvm"
                ],
                "defaultValue": "mdeTvm",
                "metadata": {
                    "displayName": "Vulnerability assessment provider type",
                    "description": "Select the vulnerability assessment solution to provision to machines."
                }
            },
            "enableAscForCspm": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            },
            "ascForCspmIsSensitiveDataDiscoveryEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Sensitive Data Discovery Enabled",
                    "description": "Enable or disable the Sensitive Data Discovery add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "ascForCspmIsContainerRegistriesVulnerabilityAssessmentsEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Container Registries Vulnerability Assessments Enabled",
                    "description": "Enable or disable the Container Registries Vulnerability Assessments add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "ascForCspmIsAgentlessDiscoveryForKubernetesEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Agentless Discovery for Kubernetes Enabled",
                    "description": "Enable or disable the Agentless Discovery for Kubernetes add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "ascForCspmIsAgentlessVmScanningEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Agentless VM Scanning Enabled",
                    "description": "Enable or disable the Agentless VM Scanning add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "ascForCspmIsEntraPermissionsManagementEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Permissions Management Enabled",
                    "description": "Enable or disable the Permissions Management add-on feature"
                },
                "allowedValues": [
                    "true",
                    "false"
                ],
                "defaultValue": "true"
            },
            "enableTvmCheck": {
                "type": "String",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "DeployIfNotExists",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "defenderForOssDb",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForOssDb')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForVM",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5eb6d64a-4086-4d7a-92da-ec51aed0332d",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForServers')]"
                    },
                    "subPlan": {
                        "value": "[[parameters('ascForServersSubPlan')]"
                    },
                    "isAgentlessVmScanningEnabled": {
                        "value": "[[parameters('ascForServersIsAgentlessVmScanningEnabled')]"
                    },
                    "isMdeDesignatedSubscriptionEnabled": {
                        "value": "[[parameters('ascForServersIsMdeDesignatedSubscriptionEnabled')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForVMVulnerabilityAssessment",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
                "definitionVersion": "4.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForServersVulnerabilityAssessments')]"
                    },
                    "vaType": {
                        "value": "[[parameters('vulnerabilityAssessmentProvider')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForSqlServerVirtualMachines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForSqlOnVm')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForAppServices",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForAppServices')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForStorageAccountsV2",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cfdc5972-75b3-4418-8ae1-7f5c36839390",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForStorage')]"
                    },
                    "isOnUploadMalwareScanningEnabled": {
                        "value": "[[parameters('ascForStorageIsOnUploadMalwareScanningEnabled')]"
                    },
                    "capGBPerMonthPerStorageAccount": {
                        "value": "[[parameters('ascForStorageCapGBPerMonthPerStorageAccount')]"
                    },
                    "isSensitiveDataDiscoveryEnabled": {
                        "value": "[[parameters('ascForStorageIsSensitiveDataDiscoveryEnabled')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderforContainers",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForContainers')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderforKubernetes",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                "definitionVersion": "4.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForContainers')]"
                    },
                    "logAnalyticsWorkspaceResourceId": {
                        "value": "[[parameters('logAnalytics')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "azurePolicyForKubernetes",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                "definitionVersion": "4.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForContainers')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForKeyVaults",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForKeyVault')]"
                    },
                    "subPlan": {
                        "value": "[[parameters('ascForKeyVaultSubPlan')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForArm",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForArm')]"
                    },
                    "subPlan": {
                        "value": "[[parameters('ascForArmSubPlan')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForSqlPaas",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForSql')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForCosmosDbs",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForCosmosDbs')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForAI",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/359a48a3-351a-4618-bb32-f1628645694b",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForAI')]"
                    },
                    "isAIPromptEvidenceEnabled": {
                        "value": "[[parameters('ascForAIIsAIPromptEvidenceEnabled')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "defenderForCspm",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/72f8cee7-2937-403d-84a1-a4e3e57f3c21",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableAscForCspm')]"
                    },
                    "isSensitiveDataDiscoveryEnabled": {
                        "value": "[[parameters('ascForCspmIsSensitiveDataDiscoveryEnabled')]"
                    },
                    "isContainerRegistriesVulnerabilityAssessmentsEnabled": {
                        "value": "[[parameters('ascForCspmIsContainerRegistriesVulnerabilityAssessmentsEnabled')]"
                    },
                    "isAgentlessDiscoveryForKubernetesEnabled": {
                        "value": "[[parameters('ascForCspmIsAgentlessDiscoveryForKubernetesEnabled')]"
                    },
                    "isAgentlessVmScanningEnabled": {
                        "value": "[[parameters('ascForCspmIsAgentlessVmScanningEnabled')]"
                    },
                    "isEntraPermissionsManagementEnabled": {
                        "value": "[[parameters('ascForCspmIsEntraPermissionsManagementEnabled')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "securityEmailContact",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "emailSecurityContact": {
                        "value": "[[parameters('emailSecurityContact')]"
                    },
                    "minimalSeverity": {
                        "value": "[[parameters('minimalSeverity')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "ascExport",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                "definitionVersion": "4.*.*",
                "parameters": {
                    "resourceGroupName": {
                        "value": "[[parameters('ascExportResourceGroupName')]"
                    },
                    "resourceGroupLocation": {
                        "value": "[[parameters('ascExportResourceGroupLocation')]"
                    },
                    "createResourceGroup": {
                        "value": "[[parameters('createResourceGroup')]"
                    },
                    "workspaceResourceId": {
                        "value": "[[parameters('logAnalytics')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "migrateToMdeTvm",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/766e621d-ba95-4e43-a6f2-e945db3d7888",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('enableTvmCheck')]"
                    }
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
  "name": "Deploy-MDFC-DefenderSQL-AMA",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2021-06-01",
  "scope": null,
  "properties": {
    "policyType": "Custom",
    "displayName": "[Deprecated]: Configure SQL VM and Arc-enabled SQL Servers to install Microsoft Defender for SQL and AMA with a user-defined LAW",
    "description": "Initiative is deprecated as the built-in initiative now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/de01d381-bae9-4670-8870-786f89f49e26.html",
    "metadata": {
      "version": "1.0.1-deprecated",
      "category": "Security Center",
      "source": "https://github.com/Azure/Enterprise-Scale/",
      "deprecated": true,
      "supersededBy": "de01d381-bae9-4670-8870-786f89f49e26",
      "alzCloudEnvironments": [
        "AzureCloud"
      ]
    },
    "parameters": {
      "effect": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "defaultValue": "DeployIfNotExists"
      },
      "workspaceRegion": {
        "type": "String",
        "metadata": {
          "displayName": "Workspace region",
          "description": "Region of the Log Analytics workspace destination for the Data Collection Rule.",
          "strongType": "location"
        }
      },
      "dcrName": {
        "type": "String",
        "metadata": {
          "displayName": "Data Collection Rule Name",
          "description": "Name of the Data Collection Rule."
        }
      },
      "dcrResourceGroup": {
        "type": "String",
        "metadata": {
          "displayName": "Data Collection Rule Resource Group",
          "description": "Resource Group of the Data Collection Rule."
        }
      },
      "dcrId": {
        "type": "String",
        "metadata": {
          "displayName": "Data Collection Rule Id",
          "description": "Id of the Data Collection Rule."
        }
      },
      "userWorkspaceResourceId": {
        "type": "String",
        "metadata": {
          "displayName": "Workspace Resource Id",
          "description": "Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.",
          "strongType": "omsWorkspace"
        }
      },
      "enableCollectionOfSqlQueriesForSecurityResearch": {
        "type": "Boolean",
        "metadata": {
          "displayName": "Enable collection of SQL queries for security research",
          "description": "Enable or disable the collection of SQL queries for security research."
        },
        "allowedValues": [
          true,
          false
        ],
        "defaultValue": false
      },
      "identityResourceGroup": {
        "type": "String",
        "metadata": {
          "displayName": "Identity Resource Group",
          "description": "The name of the resource group created by the policy."
        },
        "defaultValue": ""
      },
      "userAssignedIdentityName": {
        "type": "String",
        "metadata": {
          "displayName": "User Assigned Managed Identity Name",
          "description": "The name of the user assigned managed identity."
        },
        "defaultValue": ""
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "defenderForSqlArcAma",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3592ff98-9787-443a-af59-4505d0fe0786",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "defenderForSqlArcMdsql",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/65503269-6a54-4553-8a28-0065a8e6d929",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "defenderForSqlArcMdsqlDcr",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-Sql-DefenderSQL-DCR",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect')]"
          },
          "userWorkspaceResourceId": {
            "value": "[[parameters('userWorkspaceResourceId')]"
          },
          "workspaceRegion": {
            "value": "[[parameters('workspaceRegion')]"
          },
          "enableCollectionOfSqlQueriesForSecurityResearch": {
            "value": "[[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
          },
          "dcrName": {
            "value": "[[parameters('dcrName')]"
          },
          "dcrResourceGroup": {
            "value": "[[parameters('dcrResourceGroup')]"
          },
          "dcrId": {
            "value": "[[parameters('dcrId')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "defenderForSqlArcDcrAssociation",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-SQL-DCR-Association",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect')]"
          },
          "workspaceRegion": {
            "value": "[[parameters('workspaceRegion')]"
          },
          "dcrName": {
            "value": "[[parameters('dcrName')]"
          },
          "dcrResourceGroup": {
            "value": "[[parameters('dcrResourceGroup')]"
          },
          "dcrId": {
            "value": "[[parameters('dcrId')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "defenderForSqlAma",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-AMA",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect')]"
          },
          "identityResourceGroup": {
            "value": "[[parameters('identityResourceGroup')]"
          },
          "userAssignedIdentityName": {
            "value": "[[parameters('userAssignedIdentityName')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "defenderForSqlMdsql",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL",
        "parameters": {
          "effect": {
            "value": "[[parameters('effect')]"
          },
          "workspaceRegion": {
            "value": "[[parameters('workspaceRegion')]"
          },
          "dcrResourceGroup": {
            "value": "[[parameters('dcrResourceGroup')]"
          },
          "dcrName": {
            "value": "[[parameters('dcrName')]"
          },
          "dcrId": {
            "value": "[[parameters('dcrId')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "defenderForSqlMdsqlDcr",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL-DCR",
        "parameters": {
          "effect": {
            "value": "Disabled"
          },
          "userWorkspaceResourceId": {
            "value": "[[parameters('userWorkspaceResourceId')]"
          },
          "workspaceRegion": {
            "value": "[[parameters('workspaceRegion')]"
          },
          "enableCollectionOfSqlQueriesForSecurityResearch": {
            "value": "[[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]"
          },
          "dcrName": {
            "value": "[[parameters('dcrName')]"
          },
          "dcrResourceGroup": {
            "value": "[[parameters('dcrResourceGroup')]"
          },
          "dcrId": {
            "value": "[[parameters('dcrId')]"
          }
        },
        "groupNames": []
      }
    ],
    "policyDefinitionGroups": null
  }
},
{
  "name": "Deploy-Private-DNS-Zones",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2023-04-01",
  "scope": null,
  "properties": {
    "policyType": "Custom",
    "displayName": "Configure Azure PaaS services to use private DNS zones",
    "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones",
    "metadata": {
      "version": "2.4.0",
      "category": "Network",
      "source": "https://github.com/Azure/Enterprise-Scale/",
      "alzCloudEnvironments": [
        "AzureCloud"
      ]
    },
    "parameters": {
      "dnsZoneSubscriptionId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "Subscription Id",
          "description": "The subscription id where the private DNS zones are deployed. If this is specified, it will override any individual private DNS zone resource ids specified."
        }
      },
      "dnsZoneResourceGroupName": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "Resource Group Name",
          "description": "The resource group where the private DNS zones are deployed. If this is specified, it will override any individual private DNS zone resource ids specified."
        }
      },
      "dnsZoneResourceType": {
        "type": "string",
        "defaultValue": "Microsoft.Network/privateDnsZones",
        "metadata": {
          "displayName": "Resource Type",
          "description": "The resource type where the private DNS zones are deployed. If this is specified, it will override any individual private DNS zone resource ids specified."
        }
      },
      "dnsZoneRegion": {
        "type": "string",
        "defaultValue": "changeme",
        "metadata": {
          "displayName": "Region",
          "description": "The region where the private DNS zones are deployed. If this is specified, it will override any individual private DNS zone resource ids specified."
        }
      },
      "dnzZoneRegionShortNames": {
        "type": "object",
        "defaultValue": {
          "changeme": "changeme",
          "australiacentral" : "acl",
          "australiacentral2" : "acl2",
          "australiaeast" : "ae",
          "australiasoutheast" : "ase",
          "brazilsoutheast" : "bse",
          "brazilsouth" : "brs",
          "canadacentral" : "cnc",
          "canadaeast" : "cne",
          "centralindia" : "inc",
          "centralus" : "cus",
          "centraluseuap" : "ccy",
          "chilecentral" : "clc",
          "eastasia" : "ea",
          "eastus" : "eus",
          "eastus2" : "eus2",
          "eastus2euap" : "ecy",
          "francecentral" : "frc",
          "francesouth" : "frs",
          "germanynorth" : "gn",
          "germanywestcentral" : "gwc",
          "israelcentral" : "ilc",
          "italynorth" : "itn",
          "japaneast" : "jpe",
          "japanwest" : "jpw",
          "koreacentral" : "krc",
          "koreasouth" : "krs",
          "malaysiasouth" : "mys",
          "malaysiawest" : "myw",
          "mexicocentral" : "mxc",
          "newzealandnorth" : "nzn",
          "northcentralus" : "ncus",
          "northeurope" : "ne",
          "norwayeast" : "nwe",
          "norwaywest" : "nww",
          "polandcentral" : "plc",
          "qatarcentral" : "qac",
          "southafricanorth" : "san",
          "southafricawest" : "saw",
          "southcentralus" : "scus",
          "southeastasia" : "sea",
          "southindia" : "ins",
          "spaincentral" : "spc",
          "swedencentral" : "sdc",
          "swedensouth" : "sds",
          "switzerlandnorth" : "szn",
          "switzerlandwest" : "szw",
          "taiwannorth" : "twn",
          "uaecentral" : "uac",
          "uaenorth" : "uan",
          "uksouth" : "uks",
          "ukwest" : "ukw",
          "westcentralus" : "wcus",
          "westeurope" : "we",
          "westindia" : "inw",
          "westus" : "wus",
          "westus2" : "wus2",
          "westus3" : "wus3"
        },
        "metadata": {
          "displayName": "Region Short Name Mapping",
          "description": "Mapping of region to private DNS zone resource id. If the region is not specified, the default private DNS zone resource id will be used."
        }
      },
      "dnsZoneNames": {
        "type": "object",
        "defaultValue": {
          "azureAcrPrivateDnsZoneId": "privatelink.azurecr.io",
          "azureAcrDataPrivateDnsZoneId": "{regionName}.data.privatelink.azurecr.io",
          "azureAppPrivateDnsZoneId": "privatelink.azconfig.io",
          "azureAppServicesPrivateDnsZoneId": "privatelink.azurewebsites.net",
          "azureArcGuestconfigurationPrivateDnsZoneId": "privatelink.guestconfiguration.azure.com",
          "azureArcHybridResourceProviderPrivateDnsZoneId": "privatelink.his.arc.azure.com",
          "azureArcKubernetesConfigurationPrivateDnsZoneId": "privatelink.dp.kubernetesconfiguration.azure.com",
          "azureAsrPrivateDnsZoneId": "privatelink.siterecovery.windowsazure.com",
          "azureAutomationDSCHybridPrivateDnsZoneId": "privatelink.azure-automation.net",
          "azureAutomationWebhookPrivateDnsZoneId": "privatelink.azure-automation.net",
          "azureBatchPrivateDnsZoneId": "privatelink.batch.azure.com",
          "azureBotServicePrivateDnsZoneId": "privatelink.directline.botframework.com",
          "azureCognitiveSearchPrivateDnsZoneId": "privatelink.search.windows.net",
          "azureCognitiveServicesPrivateDnsZoneId": "privatelink.cognitiveservices.azure.com",
          "azureCosmosCassandraPrivateDnsZoneId": "privatelink.cassandra.cosmos.azure.com",
          "azureCosmosGremlinPrivateDnsZoneId": "privatelink.gremlin.cosmos.azure.com",
          "azureCosmosMongoPrivateDnsZoneId": "privatelink.mongo.cosmos.azure.com",
          "azureCosmosSQLPrivateDnsZoneId": "privatelink.documents.azure.com",
          "azureCosmosTablePrivateDnsZoneId": "privatelink.table.cosmos.azure.com",
          "azureDataExplorerPrivateDnsZoneId": "privatelink.{regionName}.kusto.windows.net",
          "azureDataFactoryPortalPrivateDnsZoneId": "privatelink.adf.azure.com",
          "azureDataFactoryPrivateDnsZoneId": "privatelink.datafactory.azure.net",
          "azureDatabricksPrivateDnsZoneId": "privatelink.azuredatabricks.net",
          "azureDiskAccessPrivateDnsZoneId": "privatelink.blob.core.windows.net",
          "azureEventGridDomainsPrivateDnsZoneId": "privatelink.eventgrid.azure.net",
          "azureEventGridTopicsPrivateDnsZoneId": "privatelink.eventgrid.azure.net",
          "azureEventHubNamespacePrivateDnsZoneId": "privatelink.servicebus.windows.net",
          "azureFilePrivateDnsZoneId": "privatelink.afs.azure.net",
          "azureHDInsightPrivateDnsZoneId": "privatelink.azurehdinsight.net",
          "azureIotCentralPrivateDnsZoneId": "privatelink.azureiotcentral.com",
          "azureIotDeviceupdatePrivateDnsZoneId": "privatelink.azure-devices.net",
          "azureIotHubsPrivateDnsZoneId": "privatelink.azure-devices.net",
          "azureIotPrivateDnsZoneId": "privatelink.azure-devices-provisioning.net",
          "azureKeyVaultPrivateDnsZoneId": "privatelink.vaultcore.azure.net",
          "azureKubernetesManagementPrivateDnsZoneId": "privatelink.{regionName}.azmk8s.io",
          "azureMachineLearningWorkspacePrivateDnsZoneId": "privatelink.api.azureml.ms",
          "azureMachineLearningWorkspaceSecondPrivateDnsZoneId": "privatelink.notebooks.azure.net",
          "azureManagedGrafanaWorkspacePrivateDnsZoneId": "privatelink.grafana.azure.com",
          "azureMediaServicesKeyPrivateDnsZoneId": "privatelink.media.azure.net",
          "azureMediaServicesLivePrivateDnsZoneId": "privatelink.media.azure.net",
          "azureMediaServicesStreamPrivateDnsZoneId": "privatelink.media.azure.net",
          "azureMigratePrivateDnsZoneId": "privatelink.prod.migration.windowsazure.com",
          "azureMonitorPrivateDnsZoneId1": "privatelink.monitor.azure.com",
          "azureMonitorPrivateDnsZoneId2": "privatelink.oms.opinsights.azure.com",
          "azureMonitorPrivateDnsZoneId3": "privatelink.ods.opinsights.azure.com",
          "azureMonitorPrivateDnsZoneId4": "privatelink.agentsvc.azure-automation.net",
          "azureMonitorPrivateDnsZoneId5": "privatelink.blob.core.windows.net",
          "azureRedisCachePrivateDnsZoneId": "privatelink.redis.cache.windows.net",
          "azureServiceBusNamespacePrivateDnsZoneId": "privatelink.servicebus.windows.net",
          "azureSignalRPrivateDnsZoneId": "privatelink.service.signalr.net",
          "azureSiteRecoveryBackupPrivateDnsZoneId": "privatelink.{regionCode}.backup.windowsazure.com",
          "azureSiteRecoveryBlobPrivateDnsZoneId": "privatelink.blob.core.windows.net",
          "azureSiteRecoveryQueuePrivateDnsZoneId": "privatelink.queue.core.windows.net",
          "azureStorageBlobPrivateDnsZoneId": "privatelink.blob.core.windows.net",
          "azureStorageBlobSecPrivateDnsZoneId": "privatelink.blob.core.windows.net",
          "azureStorageDFSPrivateDnsZoneId": "privatelink.dfs.core.windows.net",
          "azureStorageDFSSecPrivateDnsZoneId": "privatelink.dfs.core.windows.net",
          "azureStorageFilePrivateDnsZoneId": "privatelink.file.core.windows.net",
          "azureStorageQueuePrivateDnsZoneId": "privatelink.queue.core.windows.net",
          "azureStorageQueueSecPrivateDnsZoneId": "privatelink.queue.core.windows.net",
          "azureStorageStaticWebPrivateDnsZoneId": "privatelink.web.core.windows.net",
          "azureStorageStaticWebSecPrivateDnsZoneId": "privatelink.web.core.windows.net",
          "azureStorageTablePrivateDnsZoneId": "privatelink.table.core.windows.net",
          "azureStorageTableSecondaryPrivateDnsZoneId": "privatelink.table.core.windows.net",
          "azureSynapseDevPrivateDnsZoneId": "privatelink.dev.azuresynapse.net",
          "azureSynapseSQLPrivateDnsZoneId": "privatelink.sql.azuresynapse.net",
          "azureSynapseSQLODPrivateDnsZoneId": "privatelink.sql.azuresynapse.net",
          "azureVirtualDesktopHostpoolPrivateDnsZoneId": "privatelink.wvd.microsoft.com",
          "azureVirtualDesktopWorkspacePrivateDnsZoneId": "privatelink.wvd.microsoft.com",
          "azureWebPrivateDnsZoneId": "privatelink.webpubsub.azure.com"
        },
        "metadata": {
          "displayName": "DNS Zone Names",
          "description": "The list of private DNS zone names to be used for the Azure PaaS services."
        }
      },
      "azureFilePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureFilePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureAutomationWebhookPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureAutomationWebhookPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureAutomationDSCHybridPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureAutomationDSCHybridPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureCosmosSQLPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureCosmosSQLPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureCosmosMongoPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureCosmosMongoPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureCosmosCassandraPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureCosmosCassandraPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureCosmosGremlinPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureCosmosGremlinPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureCosmosTablePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureCosmosTablePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureDataFactoryPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureDataFactoryPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureDataFactoryPortalPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureDataFactoryPortalPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureDatabricksPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureDatabricksPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureHDInsightPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureHDInsightPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMigratePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMigratePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageBlobPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageBlobPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageBlobSecPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageBlobSecPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageQueuePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageQueuePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageQueueSecPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageQueueSecPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageFilePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageFilePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageStaticWebPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageStaticWebPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageStaticWebSecPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageStaticWebSecPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageDFSPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageDFSPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageDFSSecPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageDFSSecPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureSynapseSQLPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureSynapseSQLPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureSynapseSQLODPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureSynapseSQLODPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureSynapseDevPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureSynapseDevPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMediaServicesKeyPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMediaServicesKeyPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMediaServicesLivePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMediaServicesLivePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMediaServicesStreamPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMediaServicesStreamPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMonitorPrivateDnsZoneId1": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMonitorPrivateDnsZoneId1",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMonitorPrivateDnsZoneId2": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMonitorPrivateDnsZoneId2",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMonitorPrivateDnsZoneId3": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMonitorPrivateDnsZoneId3",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMonitorPrivateDnsZoneId4": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMonitorPrivateDnsZoneId4",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMonitorPrivateDnsZoneId5": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMonitorPrivateDnsZoneId5",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureWebPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureWebPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureBatchPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureBatchPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureAppPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureAppPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureAsrPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureAsrPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureIotPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureIotPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureKeyVaultPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureKeyVaultPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureSignalRPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureSignalRPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureAppServicesPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureAppServicesPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureEventGridTopicsPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureEventGridTopicsPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureDiskAccessPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureDiskAccessPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureCognitiveServicesPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureCognitiveServicesPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureIotHubsPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureIotHubsPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureEventGridDomainsPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureEventGridDomainsPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureRedisCachePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureRedisCachePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureAcrPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureAcrPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureEventHubNamespacePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureEventHubNamespacePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMachineLearningWorkspacePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMachineLearningWorkspacePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureMachineLearningWorkspaceSecondPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureMachineLearningWorkspaceSecondPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureServiceBusNamespacePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureServiceBusNamespacePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureCognitiveSearchPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureCognitiveSearchPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureBotServicePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureBotServicePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureManagedGrafanaWorkspacePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureManagedGrafanaWorkspacePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureVirtualDesktopHostpoolPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureVirtualDesktopHostpoolPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureVirtualDesktopWorkspacePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureVirtualDesktopWorkspacePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureIotDeviceupdatePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureIotDeviceupdatePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureArcGuestconfigurationPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureArcGuestconfigurationPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureArcHybridResourceProviderPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureArcHybridResourceProviderPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureArcKubernetesConfigurationPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureArcKubernetesConfigurationPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureIotCentralPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureIotCentralPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageTablePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageTablePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureStorageTableSecondaryPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureStorageTableSecondaryPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureSiteRecoveryBackupPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureSiteRecoveryBackupPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureSiteRecoveryBlobPrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureSiteRecoveryBlobPrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "azureSiteRecoveryQueuePrivateDnsZoneId": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "displayName": "azureSiteRecoveryQueuePrivateDnsZoneId",
          "strongType": "Microsoft.Network/privateDnsZones",
          "description": "Private DNS Zone Identifier"
        }
      },
      "effect": {
        "type": "string",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "defaultValue": "DeployIfNotExists"
      },
      "effect1": {
        "type": "string",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "allowedValues": [
          "deployIfNotExists",
          "Disabled"
        ],
        "defaultValue": "deployIfNotExists"
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-File-Sync",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureFilePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureFilePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Automation-Webhook",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAutomationWebhookPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAutomationWebhookPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "Webhook"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Automation-DSCHybrid",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAutomationDSCHybridPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAutomationDSCHybridPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "DSCAndHybridWorker"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-SQL",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
        "definitionVersion": "2.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosSQLPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosSQLPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "SQL"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-MongoDB",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
        "definitionVersion": "2.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosMongoPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosMongoPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "MongoDB"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-Cassandra",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
        "definitionVersion": "2.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosCassandraPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosCassandraPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "Cassandra"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-Gremlin",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
        "definitionVersion": "2.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosGremlinPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosGremlinPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "Gremlin"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Cosmos-Table",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
        "definitionVersion": "2.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCosmosTablePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCosmosTablePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "Table"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-DataFactory",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDataFactoryPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDataFactoryPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "listOfGroupIds": {
            "value": [
              "dataFactory"
            ]
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-DataFactory-Portal",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDataFactoryPortalPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDataFactoryPortalPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "listOfGroupIds": {
            "value": [
              "portal"
            ]
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Databricks-UI-Api",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0eddd7f3-3d9b-4927-a07a-806e8ac9486c",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDatabricksPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDatabricksPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "groupId": {
            "value": "databricks_ui_api"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Databricks-Browser-AuthN",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0eddd7f3-3d9b-4927-a07a-806e8ac9486c",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDatabricksPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDatabricksPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "groupId": {
            "value": "browser_authentication"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-HDInsight",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureHDInsightPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureHDInsightPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "groupId": {
            "value": "cluster"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Migrate",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMigratePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMigratePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Blob",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageBlobPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageBlobPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Blob-Sec",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageBlobSecPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageBlobSecPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Queue",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageQueuePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageQueuePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Queue-Sec",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageQueueSecPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageQueueSecPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-File",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageFilePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageFilePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-StaticWeb",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageStaticWebPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageStaticWebPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-StaticWeb-Sec",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageStaticWebSecPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageStaticWebSecPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-DFS",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageDFSPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageDFSPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-DFS-Sec",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageDFSSecPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageDFSSecPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Synapse-SQL",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
        "definitionVersion": "2.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSynapseSQLPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSynapseSQLPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "targetSubResource": {
            "value": "Sql"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Synapse-SQL-OnDemand",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
        "definitionVersion": "2.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSynapseSQLODPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSynapseSQLODPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "targetSubResource": {
            "value": "SqlOnDemand"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Synapse-Dev",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
        "definitionVersion": "2.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSynapseDevPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSynapseDevPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "targetSubResource": {
            "value": "Dev"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-MediaServices-Key",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMediaServicesKeyPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMediaServicesKeyPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "groupId": {
            "value": "keydelivery"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-MediaServices-Live",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMediaServicesLivePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMediaServicesLivePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "groupId": {
            "value": "liveevent"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-MediaServices-Stream",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMediaServicesStreamPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMediaServicesStreamPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "groupId": {
            "value": "streamingendpoint"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Monitor",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId1": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId1'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId1, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateDnsZoneId2": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId2'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId2, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateDnsZoneId3": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId3'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId3, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateDnsZoneId4": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId4'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId4, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateDnsZoneId5": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMonitorPrivateDnsZoneId5'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMonitorPrivateDnsZoneId5, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Web",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureWebPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureWebPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Batch",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureBatchPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureBatchPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-App",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAppPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAppPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Site-Recovery",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
        "definitionVersion": "1.*.*-preview",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAsrPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAsrPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-IoT",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureIotPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureIotPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-KeyVault",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureKeyVaultPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureKeyVaultPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-SignalR",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSignalRPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSignalRPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-AppServices",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAppServicesPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAppServicesPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-EventGridTopics",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureEventGridTopicsPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureEventGridTopicsPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect1')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-DiskAccess",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureDiskAccessPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureDiskAccessPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-CognitiveServices",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCognitiveServicesPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCognitiveServicesPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-IoTHubs",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureIotHubsPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureIotHubsPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect1')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-EventGridDomains",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureEventGridDomainsPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureEventGridDomainsPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect1')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-RedisCache",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureRedisCachePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureRedisCachePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-ACR",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureAcrPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureAcrPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-EventHubNamespace",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureEventHubNamespacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureEventHubNamespacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-MachineLearningWorkspace",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMachineLearningWorkspacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMachineLearningWorkspacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "secondPrivateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureMachineLearningWorkspaceSecondPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureMachineLearningWorkspaceSecondPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-ServiceBusNamespace",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureServiceBusNamespacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureServiceBusNamespacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-CognitiveSearch",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureCognitiveSearchPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureCognitiveSearchPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-BotService",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6a4e6f44-f2af-4082-9702-033c9e88b9f8",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureBotServicePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureBotServicePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-ManagedGrafanaWorkspace",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4c8537f8-cd1b-49ec-b704-18e82a42fd58",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureManagedGrafanaWorkspacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureManagedGrafanaWorkspacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-VirtualDesktopHostpool",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9427df23-0f42-4e1e-bf99-a6133d841c4a",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureVirtualDesktopHostpoolPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureVirtualDesktopHostpoolPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "connection"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-VirtualDesktopWorkspace",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34804460-d88b-4922-a7ca-537165e060ed",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureVirtualDesktopWorkspacePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureVirtualDesktopWorkspacePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateEndpointGroupId": {
            "value": "feed"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-IoTDeviceupdate",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a222b93a-e6c2-4c01-817f-21e092455b2a",
        "definitionVersion": "1.*.*",
        "parameters": {
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureIotDeviceupdatePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureIotDeviceupdatePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Arc",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55c4db33-97b0-437b-8469-c4f4498f5df9",
        "definitionVersion": "1.*.*",
        "parameters":{
          "privateDnsZoneIDForGuestConfiguration": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureArcGuestconfigurationPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureArcGuestconfigurationPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateDnsZoneIDForHybridResourceProvider": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureArcHybridResourceProviderPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureArcHybridResourceProviderPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateDnsZoneIDForKubernetesConfiguration": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureArcKubernetesConfigurationPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureArcKubernetesConfigurationPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-IoTCentral",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d627d7c6-ded5-481a-8f2e-7e16b1e6faf6",
        "definitionVersion": "1.*.*",
        "parameters":{
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureIotCentralPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureIotCentralPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Table",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/028bbd88-e9b5-461f-9424-a1b63a7bee1a",
        "definitionVersion": "1.*.*",
        "parameters":{
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageTablePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageTablePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Storage-Table-Secondary",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c1d634a5-f73d-4cdd-889f-2cc7006eb47f",
        "definitionVersion": "1.*.*",
        "parameters":{
          "privateDnsZoneId": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureStorageTableSecondaryPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureStorageTableSecondaryPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DINE-Private-DNS-Azure-Site-Recovery-Backup",
        "policyDefinitionId":"/providers/Microsoft.Authorization/policyDefinitions/af783da1-4ad1-42be-800d-d19c70038820",
        "definitionVersion": "1.*.*-preview",
        "parameters":{
          "privateDnsZone-Backup": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSiteRecoveryBackupPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSiteRecoveryBackupPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateDnsZone-Blob": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSiteRecoveryBlobPrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSiteRecoveryBlobPrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "privateDnsZone-Queue": {
            "value": "[[if(equals(parameters('dnsZoneSubscriptionId'), ''), parameters('azureSiteRecoveryQueuePrivateDnsZoneId'), format('/subscriptions/{0}/resourceGroups/{1}/providers/{2}/{3}', parameters('dnsZoneSubscriptionId'), toLower(parameters('dnsZoneResourceGroupName')), parameters('dnsZoneResourceType'), replace(replace(parameters('dnsZoneNames').azureSiteRecoveryQueuePrivateDnsZoneId, '{regionName}', parameters('dnsZoneRegion')), '{regionCode}', parameters('dnzZoneRegionShortNames')[parameters('dnsZoneRegion')])))]"
          },
          "effect": {
            "value": "[[parameters('effect')]"
          }
        }
      }
    ],
    "policyDefinitionGroups": null
  }
}
,
{
  "name": "Deploy-Sql-Security",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2021-06-01",
  "scope": null,
  "properties": {
    "policyType": "Custom",
    "displayName": "[Deprecated]: Deploy SQL Database built-in SQL security configuration",
    "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-Sql-Security_20240529.html",
    "metadata": {
      "version": "1.0.0-deprecated",
      "category": "SQL",
      "source": "https://github.com/Azure/Enterprise-Scale/",
      "deprecated": true,
      "supersededBy": "Deploy-Sql-Security_20240529",
      "alzCloudEnvironments": [
        "AzureCloud",
        "AzureChinaCloud",
        "AzureUSGovernment"
      ]
    },
    "parameters": {
      "vulnerabilityAssessmentsEmail": {
        "metadata": {
          "description": "The email address to send alerts",
          "displayName": "The email address to send alerts"
        },
        "type": "String"
      },
      "vulnerabilityAssessmentsStorageID": {
        "metadata": {
          "description": "The storage account ID to store assessments",
          "displayName": "The storage account ID to store assessments"
        },
        "type": "String"
      },
      "SqlDbTdeDeploySqlSecurityEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy SQL Database Transparent Data Encryption ",
          "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment"
        }
      },
      "SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy SQL Database security Alert Policies configuration with email admin accounts",
          "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration"
        }
      },
      "SqlDbAuditingSettingsDeploySqlSecurityEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy SQL database auditing settings",
          "description": "Deploy auditing settings to SQL Database when it not exist in the deployment"
        }
      },
      "SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy SQL Database vulnerability Assessments",
          "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters"
        }
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "SqlDbTdeDeploySqlSecurity",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
        "parameters": {
          "effect": {
            "value": "[[parameters('SqlDbTdeDeploySqlSecurityEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SqlDbSecurityAlertPoliciesDeploySqlSecurity",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
        "parameters": {
          "effect": {
            "value": "[[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SqlDbAuditingSettingsDeploySqlSecurity",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
        "parameters": {
          "effect": {
            "value": "[[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
        "parameters": {
          "effect": {
            "value": "[[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]"
          },
          "vulnerabilityAssessmentsEmail": {
            "value": "[[parameters('vulnerabilityAssessmentsEmail')]"
          },
          "vulnerabilityAssessmentsStorageID": {
            "value": "[[parameters('vulnerabilityAssessmentsStorageID')]"
          }
        },
        "groupNames": []
      }
    ],
    "policyDefinitionGroups": null
  }
}
,
{
  "name": "Deploy-Sql-Security_20240529",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2023-04-01",
  "scope": null,
  "properties": {
    "policyType": "Custom",
    "displayName": "Deploy SQL Database built-in SQL security configuration",
    "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment",
    "metadata": {
      "version": "1.1.0",
      "category": "SQL",
      "source": "https://github.com/Azure/Enterprise-Scale/",
      "replacesPolicy": "Deploy-Sql-Security",
      "alzCloudEnvironments": [
        "AzureCloud",
        "AzureChinaCloud",
        "AzureUSGovernment"
      ]
    },
    "parameters": {
      "vulnerabilityAssessmentsEmail": {
        "metadata": {
          "description": "The email address to send alerts",
          "displayName": "The email address to send alerts"
        },
        "type": "Array"
      },
      "vulnerabilityAssessmentsStorageID": {
        "metadata": {
          "description": "The storage account ID to store assessments",
          "displayName": "The storage account ID to store assessments"
        },
        "type": "String"
      },
      "SqlDbTdeDeploySqlSecurityEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy SQL Database Transparent Data Encryption ",
          "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment"
        }
      },
      "SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy SQL Database security Alert Policies configuration with email admin accounts",
          "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration"
        }
      },
      "SqlDbAuditingSettingsDeploySqlSecurityEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy SQL database auditing settings",
          "description": "Deploy auditing settings to SQL Database when it not exist in the deployment"
        }
      },
      "SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Deploy SQL Database vulnerability Assessments",
          "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters"
        }
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "SqlDbTdeDeploySqlSecurity",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
        "definitionVersion": "2.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('SqlDbTdeDeploySqlSecurityEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SqlDbSecurityAlertPoliciesDeploySqlSecurity",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SqlDbAuditingSettingsDeploySqlSecurity",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]"
          },
          "vulnerabilityAssessmentsEmail": {
            "value": "[[parameters('vulnerabilityAssessmentsEmail')]"
          },
          "vulnerabilityAssessmentsStorageID": {
            "value": "[[parameters('vulnerabilityAssessmentsStorageID')]"
          }
        },
        "groupNames": []
      }
    ],
    "policyDefinitionGroups": null
  }
}
,
{
    "name": "Enforce-ACSB",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce Azure Compute Security Benchmark compliance auditing",
        "description": "Enforce Azure Compute Security Benchmark compliance auditing for Windows and Linux virtual machines.",
        "metadata": {
            "version": "1.1.0",
            "category": "Guest Configuration",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud"
            ]
        },
        "parameters": {
            "includeArcMachines": {
                "type": "String",
                "allowedValues": [
                    "true",
                    "false"
                ],
                "metadata": {
                    "displayName": "Include Arc connected servers",
                    "description": "By selecting this option, you agree to be charged monthly per Arc connected machine."
                },
                "defaultValue": "true"
            },
            "effect": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ],
                "defaultValue": "AuditIfNotExists"
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "GcIdentity",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
                "definitionVersion": "4.*.*",
                "parameters": {},
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "GcLinux",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da",
                "definitionVersion": "3.*.*",
                "parameters": {},
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "GcWindows",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6",
                "definitionVersion": "1.*.*",
                "parameters": {},
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "WinAcsb",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    },
                    "IncludeArcMachines": {
                        "value": "[[parameters('includeArcMachines')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "LinAcsb",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    },
                    "IncludeArcMachines": {
                        "value": "[[parameters('includeArcMachines')]"
                    }
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
}
,
{
    "name": "Enforce-ALZ-Decomm",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
      "policyType": "Custom",
      "displayName": "Enforce policies in the Decommissioned Landing Zone",
      "description": "Enforce policies in the Decommissioned Landing Zone.",
      "metadata": {
        "version": "1.1.0",
        "category": "Decommissioned",
        "source": "https://github.com/Azure/Enterprise-Scale/",
        "alzCloudEnvironments": [ 
          "AzureCloud",
          "AzureChinaCloud",
          "AzureUSGovernment"
        ]
      },
      "parameters": {
        "listOfResourceTypesAllowed":{
          "type": "Array",
          "defaultValue": [],
          "metadata": {
            "displayName": "Allowed resource types in the Decommissioned landing zone",
            "description": "Allowed resource types in the Decommissioned landing zone, default is none.",
            "strongType": "resourceTypes"
          }
        }
      },
      "policyDefinitions": [
        {
          "policyDefinitionReferenceId": "DecomDenyResources",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c",
          "definitionVersion": "1.*.*",
          "parameters": {
            "listOfResourceTypesAllowed": {
              "value": "[[parameters('listOfResourceTypesAllowed')]"
            }
          },
          "groupNames": []
        },
        {
            "policyDefinitionReferenceId": "DecomShutdownMachines",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown",
            "definitionVersion": "1.*.*",
            "parameters": {},
            "groupNames": []
          }
      ],
      "policyDefinitionGroups": null
    }
  }
  ,
{
    "name": "Enforce-ALZ-Sandbox",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce policies in the Sandbox Landing Zone",
        "description": "Enforce policies in the Sandbox Landing Zone.",
        "metadata": {
            "version": "1.1.0",
            "category": "Sandbox",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "listOfResourceTypesNotAllowed": {
                "type": "Array",
                "defaultValue": [],
                "metadata": {
                    "displayName": "Not allowed resource types in the Sandbox landing zone",
                    "description": "Not allowed resource types in the Sandbox landing zone, default is none.",
                    "strongType": "resourceTypes"
                }
            },
            "effectNotAllowedResources": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "effectDenyVnetPeering": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "SandboxNotAllowed",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectNotAllowedResources')]"
                      },
                    "listOfResourceTypesNotAllowed": {
                        "value": "[[parameters('listOfResourceTypesNotAllowed')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SandboxDenyVnetPeering",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectDenyVnetPeering')]"
                      }
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Backup",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce enhanced recovery and backup policies",
        "description": "Enforce enhanced recovery and backup policies on assigned scopes.",
        "metadata": {
            "version": "1.1.0",
            "category": "Backup",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "version": "1.0.0",
        "parameters": {
            "effect": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy."
                },
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "checkLockedImmutabilityOnly": {
                "type": "Boolean",
                "metadata": {
                    "displayName": "checkLockedImmutabilityOnly",
                    "description": "This parameter checks if Immutability is locked for Backup Vaults in scope. Selecting 'true' will mark only vaults with Immutability 'Locked' as compliant. Selecting 'false' will mark vaults that have Immutability either 'Enabled' or 'Locked' as compliant."
                },
                "allowedValues": [
                    true,
                    false
                ],
                "defaultValue": false
            },
            "checkAlwaysOnSoftDeleteOnly": {
                "type": "Boolean",
                "metadata": {
                    "displayName": "CheckAlwaysOnSoftDeleteOnly",
                    "description": "This parameter checks if Soft Delete is 'Locked' for Backup Vaults in scope. Selecting 'true' will mark only vaults with Soft Delete 'AlwaysOn' as compliant. Selecting 'false' will mark vaults that have Soft Delete either 'On' or 'AlwaysOn' as compliant."
                },
                "allowedValues": [
                    true,
                    false
                ],
                "defaultValue": false
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "BackupBVault-Immutability",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2514263b-bc0d-4b06-ac3e-f262c0979018",
                "definitionVersion": "1.*.*-preview",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    },
                    "checkLockedImmutabiltyOnly": {
                        "value": "[[parameters('checkLockedImmutabilityOnly')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "BackupRVault-Immutability",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6f6f560-14b7-49a4-9fc8-d2c3a9807868",
                "definitionVersion": "1.*.*-preview",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    },
                    "checkLockedImmutabilityOnly": {
                        "value": "[[parameters('checkLockedImmutabilityOnly')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "BackupBVault-SoftDelete",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9798d31d-6028-4dee-8643-46102185c016",
                "definitionVersion": "1.*.*-preview",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    },
                    "checkAlwaysOnSoftDeleteOnly": {
                        "value": "[[parameters('checkAlwaysOnSoftDeleteOnly')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "BackupRVault-SoftDelete",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/31b8092a-36b8-434b-9af7-5ec844364148",
                "definitionVersion": "1.*.*-preview",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    },
                    "checkAlwaysOnSoftDeleteOnly": {
                        "value": "[[parameters('checkAlwaysOnSoftDeleteOnly')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "BackupBVault-MUA",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c58e083e-7982-4e24-afdc-be14d312389e",
                "definitionVersion": "1.*.*-preview",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "BackupRVault-MUA",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c7031eab-0fc0-4cd9-acd0-4497bd66d91a",
                "definitionVersion": "1.*.*-preview",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effect')]"
                    }
                },
                "groupNames": []
            }
        ],
        "policyDefinitionGroups": null
    }
}
,
{
    "name": "Enforce-EncryptTransit",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
      "policyType": "Custom",
      "displayName": "[Deprecated]: Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
      "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-EncryptTransit_20240509.html",
      "metadata": {
        "version": "2.1.0-deprecated",
        "category": "Encryption",
        "source": "https://github.com/Azure/Enterprise-Scale/",
        "deprecated": true,
        "supersededBy": "Enforce-EncryptTransit_20240509",
        "alzCloudEnvironments": [
          "AzureCloud",
          "AzureChinaCloud",
          "AzureUSGovernment"
        ]
      },
      "parameters": {
        "AppServiceHttpEffect": {
          "type": "String",
          "defaultValue": "Append",
          "allowedValues": [
            "Append",
            "Disabled"
          ],
          "metadata": {
            "displayName": "App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below",
            "description": "Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny."
          }
        },
        "AppServiceTlsVersionEffect": {
          "type": "String",
          "defaultValue": "Append",
          "allowedValues": [
            "Append",
            "Disabled"
          ],
          "metadata": {
            "displayName": "App Service. Appends the AppService WebApp, APIApp, Function App to enable https only",
            "description": "App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny."
          }
        },
        "AppServiceminTlsVersion": {
          "type": "String",
          "defaultValue": "1.2",
          "allowedValues": [
            "1.2",
            "1.0",
            "1.1"
          ],
          "metadata": {
            "displayName": "App Service. Select version minimum TLS Web App config",
            "description": "App Service. Select version  minimum TLS version for a  Web App config to enforce"
          }
        },
        "APIAppServiceHttpsEffect": {
          "metadata": {
            "displayName": "App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
            "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Disabled",
            "Deny"
          ]
        },
        "FunctionLatestTlsEffect": {
          "metadata": {
            "displayName": "App Service Function App. Latest TLS version should be used in your Function App",
            "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version."
          },
          "type": "String",
          "defaultValue": "AuditIfNotExists",
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ]
        },
        "FunctionServiceHttpsEffect": {
          "metadata": {
            "displayName": "App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
            "description": "App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Disabled",
            "Deny"
          ]
        },
        "WebAppServiceLatestTlsEffect": {
          "metadata": {
            "displayName": "App Service Web App. Latest TLS version should be used in your Web App",
            "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version."
          },
          "type": "String",
          "defaultValue": "AuditIfNotExists",
          "allowedValues": [
            "AuditIfNotExists",
            "Disabled"
          ]
        },
        "WebAppServiceHttpsEffect": {
          "metadata": {
            "displayName": "App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
            "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Disabled",
            "Deny"
          ]
        },
        "AKSIngressHttpsOnlyEffect": {
          "metadata": {
            "displayName": "AKS Service. Enforce HTTPS ingress in Kubernetes cluster",
            "description": "This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc."
          },
          "type": "String",
          "defaultValue": "deny",
          "allowedValues": [
            "audit",
            "deny",
            "disabled"
          ]
        },
        "MySQLEnableSSLDeployEffect": {
          "type": "String",
          "defaultValue": "DeployIfNotExists",
          "allowedValues": [
            "DeployIfNotExists",
            "Disabled"
          ],
          "metadata": {
            "displayName": "MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server",
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
          }
        },
        "MySQLEnableSSLEffect": {
          "metadata": {
            "displayName": "MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers",
            "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Disabled",
            "Deny"
          ]
        },
        "MySQLminimalTlsVersion": {
          "type": "String",
          "defaultValue": "TLS1_2",
          "allowedValues": [
            "TLS1_2",
            "TLS1_0",
            "TLS1_1",
            "TLSEnforcementDisabled"
          ],
          "metadata": {
            "displayName": "MySQL database servers. Select version minimum TLS for MySQL server",
            "description": "Select version  minimum TLS version Azure Database for MySQL server to enforce"
          }
        },
        "PostgreSQLEnableSSLDeployEffect": {
          "type": "String",
          "defaultValue": "DeployIfNotExists",
          "allowedValues": [
            "DeployIfNotExists",
            "Disabled"
          ],
          "metadata": {
            "displayName": "PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server",
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
          }
        },
        "PostgreSQLEnableSSLEffect": {
          "metadata": {
            "displayName": "PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers",
            "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Disabled",
            "Deny"
          ]
        },
        "PostgreSQLminimalTlsVersion": {
          "type": "String",
          "defaultValue": "TLS1_2",
          "allowedValues": [
            "TLS1_2",
            "TLS1_0",
            "TLS1_1",
            "TLSEnforcementDisabled"
          ],
          "metadata": {
            "displayName": "PostgreSQL database servers. Select version minimum TLS for MySQL server",
            "description": "PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce"
          }
        },
        "RedisTLSDeployEffect": {
          "type": "String",
          "defaultValue": "Append",
          "allowedValues": [
            "Append",
            "Disabled"
          ],
          "metadata": {
            "displayName": "Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis",
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
          }
        },
        "RedisMinTlsVersion": {
          "type": "String",
          "defaultValue": "1.2",
          "allowedValues": [
            "1.2",
            "1.0",
            "1.1"
          ],
          "metadata": {
            "displayName": "Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis",
            "description": "Select version  minimum TLS version for a Azure Cache for Redis to enforce"
          }
        },
        "RedisTLSEffect": {
          "metadata": {
            "displayName": "Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled",
            "description": "Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking."
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Deny",
            "Disabled"
          ]
        },
        "SQLManagedInstanceTLSDeployEffect": {
          "type": "String",
          "defaultValue": "DeployIfNotExists",
          "allowedValues": [
            "DeployIfNotExists",
            "Disabled"
          ],
          "metadata": {
            "displayName": "Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers",
            "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
          }
        },
        "SQLManagedInstanceMinTlsVersion": {
          "type": "String",
          "defaultValue": "1.2",
          "allowedValues": [
            "1.2",
            "1.0",
            "1.1"
          ],
          "metadata": {
            "displayName": "Azure Managed Instance.Select version minimum TLS for Azure Managed Instance",
            "description": "Select version  minimum TLS version for Azure Managed Instanceto to  enforce"
          }
        },
        "SQLManagedInstanceTLSEffect": {
          "metadata": {
            "displayName": "SQL Managed Instance should have the minimal TLS version of 1.2",
            "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities."
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Disabled",
            "Deny"
          ]
        },
        "SQLServerTLSDeployEffect": {
          "type": "String",
          "defaultValue": "DeployIfNotExists",
          "allowedValues": [
            "DeployIfNotExists",
            "Disabled"
          ],
          "metadata": {
            "displayName": "Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers",
            "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
          }
        },
        "SQLServerminTlsVersion": {
          "type": "String",
          "defaultValue": "1.2",
          "allowedValues": [
            "1.2",
            "1.0",
            "1.1"
          ],
          "metadata": {
            "displayName": "Azure SQL Database.Select version minimum TLS for Azure SQL Database",
            "description": "Select version  minimum TLS version for Azure SQL Database to enforce"
          }
        },
        "SQLServerTLSEffect": {
          "metadata": {
            "displayName": "Azure SQL Database should have the minimal TLS version of 1.2",
            "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities."
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Disabled",
            "Deny"
          ]
        },
        "StorageDeployHttpsEnabledEffect": {
          "metadata": {
            "displayName": "Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled",
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking"
          },
          "type": "String",
          "defaultValue": "DeployIfNotExists",
          "allowedValues": [
            "DeployIfNotExists",
            "Disabled"
          ]
        },
        "StorageminimumTlsVersion": {
          "type": "String",
          "defaultValue": "TLS1_2",
          "allowedValues": [
            "TLS1_2",
            "TLS1_1",
            "TLS1_0"
          ],
          "metadata": {
            "displayName": "Storage Account select minimum TLS version",
            "description": "Select version  minimum TLS version on Azure Storage Account to enforce"
          }
        },
        "StorageHttpsEnabledEffect": {
          "metadata": {
            "displayName": "Azure Storage Account. Secure transfer to storage accounts should be enabled",
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking"
          },
          "type": "String",
          "defaultValue": "Audit",
          "allowedValues": [
            "Audit",
            "Deny",
            "Disabled"
          ]
        },
        "ContainerAppsHttpsOnlyEffect": {
          "metadata": {
            "displayName": "Container Apps should only be accessible over HTTPS",
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps."
          },
          "type": "String",
          "defaultValue": "Deny",
          "allowedValues": [
            "Audit",
            "Deny",
            "Disabled"
          ]
        }
      },
      "policyDefinitions": [
        {
          "policyDefinitionReferenceId": "AppServiceHttpEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
          "parameters": {
            "effect": {
              "value": "[[parameters('AppServiceHttpEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "AppServiceminTlsVersion",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
          "parameters": {
            "effect": {
              "value": "[[parameters('AppServiceTlsVersionEffect')]"
            },
            "minTlsVersion": {
              "value": "[[parameters('AppServiceminTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "FunctionLatestTlsEffect",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
          "parameters": {
            "effect": {
              "value": "[[parameters('FunctionLatestTlsEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "WebAppServiceLatestTlsEffect",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
          "parameters": {
            "effect": {
              "value": "[[parameters('WebAppServiceLatestTlsEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "APIAppServiceHttpsEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
          "parameters": {
            "effect": {
              "value": "[[parameters('APIAppServiceHttpsEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "FunctionServiceHttpsEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
          "parameters": {
            "effect": {
              "value": "[[parameters('FunctionServiceHttpsEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "WebAppServiceHttpsEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
          "parameters": {
            "effect": {
              "value": "[[parameters('WebAppServiceHttpsEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "AKSIngressHttpsOnlyEffect",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
          "parameters": {
            "effect": {
              "value": "[[parameters('AKSIngressHttpsOnlyEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "MySQLEnableSSLDeployEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
          "parameters": {
            "effect": {
              "value": "[[parameters('MySQLEnableSSLDeployEffect')]"
            },
            "minimalTlsVersion": {
              "value": "[[parameters('MySQLminimalTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "MySQLEnableSSLEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
          "parameters": {
            "effect": {
              "value": "[[parameters('MySQLEnableSSLEffect')]"
            },
            "minimalTlsVersion": {
              "value": "[[parameters('MySQLminimalTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "PostgreSQLEnableSSLDeployEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
          "parameters": {
            "effect": {
              "value": "[[parameters('PostgreSQLEnableSSLDeployEffect')]"
            },
            "minimalTlsVersion": {
              "value": "[[parameters('PostgreSQLminimalTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "PostgreSQLEnableSSLEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
          "parameters": {
            "effect": {
              "value": "[[parameters('PostgreSQLEnableSSLEffect')]"
            },
            "minimalTlsVersion": {
              "value": "[[parameters('PostgreSQLminimalTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "RedisTLSDeployEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
          "parameters": {
            "effect": {
              "value": "[[parameters('RedisTLSDeployEffect')]"
            },
            "minimumTlsVersion": {
              "value": "[[parameters('RedisMinTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "RedisdisableNonSslPort",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
          "parameters": {
            "effect": {
              "value": "[[parameters('RedisTLSDeployEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "RedisDenyhttps",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
          "parameters": {
            "effect": {
              "value": "[[parameters('RedisTLSEffect')]"
            },
            "minimumTlsVersion": {
              "value": "[[parameters('RedisMinTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "SQLManagedInstanceTLSDeployEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
          "parameters": {
            "effect": {
              "value": "[[parameters('SQLManagedInstanceTLSDeployEffect')]"
            },
            "minimalTlsVersion": {
              "value": "[[parameters('SQLManagedInstanceMinTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "SQLManagedInstanceTLSEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
          "parameters": {
            "effect": {
              "value": "[[parameters('SQLManagedInstanceTLSEffect')]"
            },
            "minimalTlsVersion": {
              "value": "[[parameters('SQLManagedInstanceMinTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "SQLServerTLSDeployEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
          "parameters": {
            "effect": {
              "value": "[[parameters('SQLServerTLSDeployEffect')]"
            },
            "minimalTlsVersion": {
              "value": "[[parameters('SQLServerminTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "SQLServerTLSEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
          "parameters": {
            "effect": {
              "value": "[[parameters('SQLServerTLSEffect')]"
            },
            "minimalTlsVersion": {
              "value": "[[parameters('SQLServerminTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "StorageHttpsEnabledEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
          "parameters": {
            "effect": {
              "value": "[[parameters('StorageHttpsEnabledEffect')]"
            },
            "minimumTlsVersion": {
              "value": "[[parameters('StorageMinimumTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "StorageDeployHttpsEnabledEffect",
          "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
          "parameters": {
            "effect": {
              "value": "[[parameters('StorageDeployHttpsEnabledEffect')]"
            },
            "minimumTlsVersion": {
              "value": "[[parameters('StorageMinimumTlsVersion')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "ContainerAppsHttpsOnlyEffect",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
          "parameters": {
            "effect": {
              "value": "[[parameters('ContainerAppsHttpsOnlyEffect')]"
            }
          },
          "groupNames": []
        }
      ],
      "policyDefinitionGroups": null
    }
  },
{
    "name": "Enforce-EncryptTransit_20240509",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "[Deprecated]: Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
        "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-EncryptTransit_20241211.html ",
        "metadata": {
            "version": "1.0.0-deprecated",
            "category": "Encryption",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "replacesPolicy": "Enforce-EncryptTransit",        
            "deprecated": true,
            "supersededBy": "Enforce-EncryptTransit_20241211",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "AppServiceHttpEffect": {
                "type": "String",
                "defaultValue": "Append",
                "allowedValues": [
                    "Append",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below",
                    "description": "Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny."
                }
            },
            "AppServiceTlsVersionEffect": {
                "type": "String",
                "defaultValue": "Append",
                "allowedValues": [
                    "Append",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "App Service. Appends the AppService WebApp, APIApp, Function App to enable https only",
                    "description": "App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny."
                }
            },
            "AppServiceminTlsVersion": {
                "type": "String",
                "defaultValue": "1.2",
                "allowedValues": [
                    "1.3",
                    "1.2",
                    "1.1",
                    "1.0"
                ],
                "metadata": {
                    "displayName": "App Service. Select version minimum TLS Web App config",
                    "description": "App Service. Select version  minimum TLS version for a  Web App config to enforce"
                }
            },
            "APIAppServiceHttpsEffect": {
                "metadata": {
                    "displayName": "App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
                    "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
                },
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "FunctionLatestTlsEffect": {
                "metadata": {
                    "displayName": "App Service Function App. Latest TLS version should be used in your Function App",
                    "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version."
                },
                "type": "String",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ]
            },
            "FunctionServiceHttpsEffect": {
                "metadata": {
                    "displayName": "App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
                    "description": "App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
                },
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "FunctionAppTlsEffect": {
                "metadata": {
                    "displayName": "App Service Function App. Configure Function apps to use the latest TLS version.",
                    "description": "App Service Function App. Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version."
                },
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "LogicAppTlsEffect": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "WebAppServiceLatestTlsEffect": {
                "metadata": {
                    "displayName": "App Service Web App. Latest TLS version should be used in your Web App",
                    "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version."
                },
                "type": "String",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ]
            },
            "WebAppServiceHttpsEffect": {
                "metadata": {
                    "displayName": "App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
                    "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
                },
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "AKSIngressHttpsOnlyEffect": {
                "metadata": {
                    "displayName": "AKS Service. Enforce HTTPS ingress in Kubernetes cluster",
                    "description": "This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc."
                },
                "type": "String",
                "defaultValue": "deny",
                "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                ]
            },
            "MySQLEnableSSLDeployEffect": {
                "type": "String",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server",
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
                }
            },
            "MySQLEnableSSLEffect": {
                "metadata": {
                    "displayName": "MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers",
                    "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
                },
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "MySQLminimalTlsVersion": {
                "type": "String",
                "defaultValue": "TLS1_2",
                "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                ],
                "metadata": {
                    "displayName": "MySQL database servers. Select version minimum TLS for MySQL server",
                    "description": "Select version  minimum TLS version Azure Database for MySQL server to enforce"
                }
            },
            "PostgreSQLEnableSSLDeployEffect": {
                "type": "String",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server",
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
                }
            },
            "PostgreSQLEnableSSLEffect": {
                "metadata": {
                    "displayName": "PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers",
                    "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
                },
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "PostgreSQLminimalTlsVersion": {
                "type": "String",
                "defaultValue": "TLS1_2",
                "allowedValues": [
                    "TLS1_2",
                    "TLS1_0",
                    "TLS1_1",
                    "TLSEnforcementDisabled"
                ],
                "metadata": {
                    "displayName": "PostgreSQL database servers. Select version minimum TLS for MySQL server",
                    "description": "PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce"
                }
            },
            "RedisTLSDeployEffect": {
                "type": "String",
                "defaultValue": "Append",
                "allowedValues": [
                    "Append",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis",
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
                }
            },
            "RedisMinTlsVersion": {
                "type": "String",
                "defaultValue": "1.2",
                "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                ],
                "metadata": {
                    "displayName": "Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis",
                    "description": "Select version  minimum TLS version for a Azure Cache for Redis to enforce"
                }
            },
            "RedisTLSEffect": {
                "metadata": {
                    "displayName": "Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled",
                    "description": "Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking."
                },
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "SQLManagedInstanceTLSDeployEffect": {
                "type": "String",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers",
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
                }
            },
            "SQLManagedInstanceMinTlsVersion": {
                "type": "String",
                "defaultValue": "1.2",
                "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                ],
                "metadata": {
                    "displayName": "Azure Managed Instance.Select version minimum TLS for Azure Managed Instance",
                    "description": "Select version  minimum TLS version for Azure Managed Instanceto to  enforce"
                }
            },
            "SQLManagedInstanceTLSEffect": {
                "metadata": {
                    "displayName": "SQL Managed Instance should have the minimal TLS version of 1.2",
                    "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities."
                },
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "SQLServerTLSDeployEffect": {
                "type": "String",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers",
                    "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
                }
            },
            "SQLServerminTlsVersion": {
                "type": "String",
                "defaultValue": "1.2",
                "allowedValues": [
                    "1.2",
                    "1.0",
                    "1.1"
                ],
                "metadata": {
                    "displayName": "Azure SQL Database.Select version minimum TLS for Azure SQL Database",
                    "description": "Select version  minimum TLS version for Azure SQL Database to enforce"
                }
            },
            "SQLServerTLSEffect": {
                "metadata": {
                    "displayName": "Azure SQL Database should have the minimal TLS version of 1.2",
                    "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities."
                },
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "StorageDeployHttpsEnabledEffect": {
                "metadata": {
                    "displayName": "Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled",
                    "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking"
                },
                "type": "String",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "StorageMinimumTlsVersion": {
                "type": "String",
                "defaultValue": "TLS1_2",
                "allowedValues": [
                    "TLS1_2",
                    "TLS1_1",
                    "TLS1_0"
                ],
                "metadata": {
                    "displayName": "Storage Account select minimum TLS version",
                    "description": "Select version  minimum TLS version on Azure Storage Account to enforce"
                }
            },
            "ContainerAppsHttpsOnlyEffect": {
                "metadata": {
                    "displayName": "Container Apps should only be accessible over HTTPS",
                    "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps."
                },
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "logicAppHttpsEffect": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceAppsTls": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "functionAppSlotsTls": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "appServiceAppsHttps": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceTls": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceAppSlotTls": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "functionAppSlotsHttps": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "functionAppHttps": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceAppSlotsHttps": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerAppsHttps": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventHubMinTls": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "sqlManagedTlsVersion": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "sqlDbTls": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsTls": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "synapseTlsVersion": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "AppServiceHttpEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AppServiceHttpEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AppServiceminTlsVersion",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AppServiceTlsVersionEffect')]"
                    },
                    "minTlsVersion": {
                        "value": "[[parameters('AppServiceminTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "FunctionLatestTlsEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('FunctionLatestTlsEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "WebAppServiceLatestTlsEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('WebAppServiceLatestTlsEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "APIAppServiceHttpsEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('APIAppServiceHttpsEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "FunctionServiceHttpsEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('FunctionServiceHttpsEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "WebAppServiceHttpsEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('WebAppServiceHttpsEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AKSIngressHttpsOnlyEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                "definitionVersion": "8.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AKSIngressHttpsOnlyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "MySQLEnableSSLDeployEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('MySQLEnableSSLDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                        "value": "[[parameters('MySQLminimalTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "MySQLEnableSSLEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('MySQLEnableSSLEffect')]"
                    },
                    "minimalTlsVersion": {
                        "value": "[[parameters('MySQLminimalTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "PostgreSQLEnableSSLDeployEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('PostgreSQLEnableSSLDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                        "value": "[[parameters('PostgreSQLminimalTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "PostgreSQLEnableSSLEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('PostgreSQLEnableSSLEffect')]"
                    },
                    "minimalTlsVersion": {
                        "value": "[[parameters('PostgreSQLminimalTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "RedisTLSDeployEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('RedisTLSDeployEffect')]"
                    },
                    "minimumTlsVersion": {
                        "value": "[[parameters('RedisMinTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "RedisdisableNonSslPort",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('RedisTLSDeployEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "RedisDenyhttps",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('RedisTLSEffect')]"
                    },
                    "minimumTlsVersion": {
                        "value": "[[parameters('RedisMinTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SQLManagedInstanceTLSDeployEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SQLManagedInstanceTLSDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                        "value": "[[parameters('SQLManagedInstanceMinTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SQLManagedInstanceTLSEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SQLManagedInstanceTLSEffect')]"
                    },
                    "minimalTlsVersion": {
                        "value": "[[parameters('SQLManagedInstanceMinTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SQLServerTLSDeployEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SQLServerTLSDeployEffect')]"
                    },
                    "minimalTlsVersion": {
                        "value": "[[parameters('SQLServerminTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SQLServerTLSEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SQLServerTLSEffect')]"
                    },
                    "minimalTlsVersion": {
                        "value": "[[parameters('SQLServerminTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "StorageDeployHttpsEnabledEffect",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('StorageDeployHttpsEnabledEffect')]"
                    },
                    "minimumTlsVersion": {
                        "value": "[[parameters('StorageMinimumTlsVersion')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "ContainerAppsHttpsOnlyEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('ContainerAppsHttpsOnlyEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "Dine-FunctionApp-Tls",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('FunctionAppTlsEffect')]"
                    }
                }
            },
            {
                "policyDefinitionReferenceId": "Deploy-LogicApp-TLS",
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('LogicAppTlsEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https",
                "policyDefinitionReferenceId": "Deny-LogicApp-Without-Https",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('logicAppHttpsEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fa3a6357-c6d6-4120-8429-855577ec0063",
                "policyDefinitionReferenceId": "Dine-Function-Apps-Slots-Tls",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('functionAppSlotsTls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae44c1d1-0df2-4ca9-98fa-a3d3ae5b409d",
                "policyDefinitionReferenceId": "Dine-AppService-Apps-Tls",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppsTls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
                "policyDefinitionReferenceId": "Deny-AppService-Apps-Https",
                "definitionVersion": "4.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppsHttps')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6545c6b-dd9d-4265-91e6-0b451e2f1c50",
                "policyDefinitionReferenceId": "Deny-AppService-Tls",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceTls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/014664e7-e348-41a3-aeb9-566e4ff6a9df",
                "policyDefinitionReferenceId": "DINE-AppService-AppSlotTls",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppSlotTls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e5dbe3f-2702-4ffc-8b1e-0cae008a5c71",
                "policyDefinitionReferenceId": "Deny-FuncAppSlots-Https",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('functionAppSlotsHttps')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
                "policyDefinitionReferenceId": "Deny-FunctionApp-Https",
                "definitionVersion": "5.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('functionAppHttps')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae1b9a8c-dfce-4605-bd91-69213b4a26fc",
                "policyDefinitionReferenceId": "Deny-AppService-Slots-Https",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppSlotsHttps')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                "policyDefinitionReferenceId": "Deny-ContainerApps-Https",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerAppsHttps')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS",
                "policyDefinitionReferenceId": "Deny-EH-minTLS",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubMinTls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8793640-60f7-487c-b5c3-1d37215905c4",
                "policyDefinitionReferenceId": "Deny-Sql-Managed-Tls-Version",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('sqlManagedTlsVersion')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
                "policyDefinitionReferenceId": "Deny-Sql-Db-Tls",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('sqlDbTls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
                "policyDefinitionReferenceId": "Deny-Storage-Tls",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsTls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cb3738a6-82a2-4a18-b87b-15217b9deff4",
                "policyDefinitionReferenceId": "Deny-Synapse-Tls-Version",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseTlsVersion')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
}
,
{
  "name": "Enforce-EncryptTransit_20241211",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2023-04-01",
  "scope": null,
  "properties": {
    "policyType": "Custom",
    "displayName": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
    "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit.",
    "metadata": {
      "version": "1.2.2",
      "category": "Encryption",
      "source": "https://github.com/Azure/Enterprise-Scale/",
      "replacesPolicy": "Enforce-EncryptTransit_20240509",
      "alzCloudEnvironments": [
        "AzureCloud",
        "AzureChinaCloud",
        "AzureUSGovernment"
      ]
    },
    "parameters": {
      "AppServiceHttpEffect": {
        "type": "String",
        "defaultValue": "Append",
        "allowedValues": [
          "Append",
          "Disabled"
        ],
        "metadata": {
          "displayName": "App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below",
          "description": "Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny."
        }
      },
      "AppServiceTlsVersionEffect": {
        "type": "String",
        "defaultValue": "Append",
        "allowedValues": [
          "Append",
          "Disabled"
        ],
        "metadata": {
          "displayName": "App Service. Appends the AppService WebApp, APIApp, Function App to enable https only",
          "description": "App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny."
        }
      },
      "AppServiceminTlsVersion": {
        "type": "String",
        "defaultValue": "1.2",
        "allowedValues": [
          "1.3",
          "1.2",
          "1.1",
          "1.0"
        ],
        "metadata": {
          "displayName": "App Service. Select version minimum TLS Web App config",
          "description": "App Service. Select version  minimum TLS version for a  Web App config to enforce"
        }
      },
      "APIAppServiceHttpsEffect": {
        "metadata": {
          "displayName": "App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
          "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
        },
        "type": "String",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ]
      },
      "FunctionLatestTlsEffect": {
        "metadata": {
          "displayName": "App Service Function App. Latest TLS version should be used in your Function App",
          "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version."
        },
        "type": "String",
        "defaultValue": "AuditIfNotExists",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ]
      },
      "FunctionServiceHttpsEffect": {
        "metadata": {
          "displayName": "App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
          "description": "App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
        },
        "type": "String",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ]
      },
      "FunctionAppTlsEffect": {
        "metadata": {
          "displayName": "App Service Function App. Configure Function apps to use the latest TLS version.",
          "description": "App Service Function App. Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version."
        },
        "type": "string",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ]
      },
      "LogicAppTlsEffect": {
        "type": "string",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ]
      },
      "WebAppServiceLatestTlsEffect": {
        "metadata": {
          "displayName": "App Service Web App. Latest TLS version should be used in your Web App",
          "description": "Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version."
        },
        "type": "String",
        "defaultValue": "AuditIfNotExists",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ]
      },
      "WebAppServiceHttpsEffect": {
        "metadata": {
          "displayName": "App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.",
          "description": "Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks."
        },
        "type": "String",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ]
      },
      "AKSIngressHttpsOnlyEffect": {
        "metadata": {
          "displayName": "AKS Service. Enforce HTTPS ingress in Kubernetes cluster",
          "description": "This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc."
        },
        "type": "String",
        "defaultValue": "deny",
        "allowedValues": [
          "audit",
          "deny",
          "disabled"
        ]
      },
      "MySQLEnableSSLDeployEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server",
          "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
        }
      },
      "MySQLEnableSSLEffect": {
        "metadata": {
          "displayName": "MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers",
          "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
        },
        "type": "String",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ]
      },
      "MySQLminimalTlsVersion": {
        "type": "String",
        "defaultValue": "TLS1_2",
        "allowedValues": [
          "TLS1_2",
          "TLS1_0",
          "TLS1_1",
          "TLSEnforcementDisabled"
        ],
        "metadata": {
          "displayName": "MySQL database servers. Select version minimum TLS for MySQL server",
          "description": "Select version  minimum TLS version Azure Database for MySQL server to enforce"
        }
      },
      "PostgreSQLEnableSSLDeployEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server",
          "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
        }
      },
      "PostgreSQLEnableSSLEffect": {
        "metadata": {
          "displayName": "PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers",
          "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
        },
        "type": "String",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ]
      },
      "PostgreSQLminimalTlsVersion": {
        "type": "String",
        "defaultValue": "TLS1_2",
        "allowedValues": [
          "TLS1_2",
          "TLS1_0",
          "TLS1_1",
          "TLSEnforcementDisabled"
        ],
        "metadata": {
          "displayName": "PostgreSQL database servers. Select version minimum TLS for MySQL server",
          "description": "PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce"
        }
      },
      "RedisTLSDeployEffect": {
        "type": "String",
        "defaultValue": "Append",
        "allowedValues": [
          "Append",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis",
          "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
        }
      },
      "RedisMinTlsVersion": {
        "type": "String",
        "defaultValue": "1.2",
        "allowedValues": [
          "1.2",
          "1.0",
          "1.1"
        ],
        "metadata": {
          "displayName": "Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis",
          "description": "Select version  minimum TLS version for a Azure Cache for Redis to enforce"
        }
      },
      "RedisTLSEffect": {
        "metadata": {
          "displayName": "Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled",
          "description": "Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking."
        },
        "type": "String",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "SQLManagedInstanceTLSDeployEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers",
          "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
        }
      },
      "SQLManagedInstanceMinTlsVersion": {
        "type": "String",
        "defaultValue": "1.2",
        "allowedValues": [
          "1.2",
          "1.0",
          "1.1"
        ],
        "metadata": {
          "displayName": "Azure Managed Instance.Select version minimum TLS for Azure Managed Instance",
          "description": "Select version  minimum TLS version for Azure Managed Instanceto to  enforce"
        }
      },
      "SQLManagedInstanceTLSEffect": {
        "metadata": {
          "displayName": "SQL Managed Instance should have the minimal TLS version of 1.2",
          "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities."
        },
        "type": "String",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ]
      },
      "SQLServerTLSDeployEffect": {
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers",
          "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server."
        }
      },
      "SQLServerminTlsVersion": {
        "type": "String",
        "defaultValue": "1.2",
        "allowedValues": [
          "1.2",
          "1.0",
          "1.1"
        ],
        "metadata": {
          "displayName": "Azure SQL Database.Select version minimum TLS for Azure SQL Database",
          "description": "Select version  minimum TLS version for Azure SQL Database to enforce"
        }
      },
      "SQLServerTLSEffect": {
        "metadata": {
          "displayName": "Azure SQL Database should have the minimal TLS version of 1.2",
          "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities."
        },
        "type": "String",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled",
          "Deny"
        ]
      },
      "StorageDeployHttpsEnabledEffect": {
        "metadata": {
          "displayName": "Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled",
          "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking"
        },
        "type": "String",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ]
      },
      "StorageMinimumTlsVersion": {
        "type": "String",
        "defaultValue": "TLS1_2",
        "allowedValues": [
          "TLS1_2",
          "TLS1_1",
          "TLS1_0"
        ],
        "metadata": {
          "displayName": "Storage Account select minimum TLS version",
          "description": "Select version  minimum TLS version on Azure Storage Account to enforce"
        }
      },
      "ContainerAppsHttpsOnlyEffect": {
        "metadata": {
          "displayName": "Container Apps should only be accessible over HTTPS",
          "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps."
        },
        "type": "String",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "logicAppHttpsEffect": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "appServiceAppsTls": {
        "type": "string",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ]
      },
      "functionAppSlotsTls": {
        "type": "string",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ]
      },
      "appServiceAppsHttps": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "appServiceTls": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "appServiceAppSlotTls": {
        "type": "string",
        "defaultValue": "DeployIfNotExists",
        "allowedValues": [
          "DeployIfNotExists",
          "Disabled"
        ]
      },
      "functionAppSlotsHttps": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "functionAppHttps": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "appServiceAppSlotsHttps": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "eventHubMinTls": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "sqlManagedTlsVersion": {
        "type": "string",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled"
        ]
      },
      "sqlDbTls": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "storageAccountsTls": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "synapseTlsVersion": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "AppServiceHttpEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('AppServiceHttpEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AppServiceminTlsVersion",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('AppServiceTlsVersionEffect')]"
          },
          "minTlsVersion": {
            "value": "[[parameters('AppServiceminTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "FunctionLatestTlsEffect",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
        "definitionVersion": "2.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('FunctionLatestTlsEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "WebAppServiceLatestTlsEffect",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
        "definitionVersion": "2.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('WebAppServiceLatestTlsEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "APIAppServiceHttpsEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('APIAppServiceHttpsEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "FunctionServiceHttpsEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('FunctionServiceHttpsEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "WebAppServiceHttpsEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('WebAppServiceHttpsEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "AKSIngressHttpsOnlyEffect",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
        "definitionVersion": "8.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('AKSIngressHttpsOnlyEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "MySQLEnableSSLDeployEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('MySQLEnableSSLDeployEffect')]"
          },
          "minimalTlsVersion": {
            "value": "[[parameters('MySQLminimalTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "MySQLEnableSSLEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('MySQLEnableSSLEffect')]"
          },
          "minimalTlsVersion": {
            "value": "[[parameters('MySQLminimalTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PostgreSQLEnableSSLDeployEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('PostgreSQLEnableSSLDeployEffect')]"
          },
          "minimalTlsVersion": {
            "value": "[[parameters('PostgreSQLminimalTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "PostgreSQLEnableSSLEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('PostgreSQLEnableSSLEffect')]"
          },
          "minimalTlsVersion": {
            "value": "[[parameters('PostgreSQLminimalTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "RedisTLSDeployEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('RedisTLSDeployEffect')]"
          },
          "minimumTlsVersion": {
            "value": "[[parameters('RedisMinTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "RedisdisableNonSslPort",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('RedisTLSDeployEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "RedisDenyhttps",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('RedisTLSEffect')]"
          },
          "minimumTlsVersion": {
            "value": "[[parameters('RedisMinTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQLManagedInstanceTLSDeployEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('SQLManagedInstanceTLSDeployEffect')]"
          },
          "minimalTlsVersion": {
            "value": "[[parameters('SQLManagedInstanceMinTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQLManagedInstanceTLSEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('SQLManagedInstanceTLSEffect')]"
          },
          "minimalTlsVersion": {
            "value": "[[parameters('SQLManagedInstanceMinTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQLServerTLSDeployEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('SQLServerTLSDeployEffect')]"
          },
          "minimalTlsVersion": {
            "value": "[[parameters('SQLServerminTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQLServerTLSEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('SQLServerTLSEffect')]"
          },
          "minimalTlsVersion": {
            "value": "[[parameters('SQLServerminTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "StorageDeployHttpsEnabledEffect",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('StorageDeployHttpsEnabledEffect')]"
          },
          "minimumTlsVersion": {
            "value": "[[parameters('StorageMinimumTlsVersion')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "ContainerAppsHttpsOnlyEffect",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
        "definitionVersion": "1.*.*",
        "parameters": {
          "effect": {
            "value": "[[parameters('ContainerAppsHttpsOnlyEffect')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Dine-FunctionApp-Tls",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('FunctionAppTlsEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Deploy-LogicApp-TLS",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('LogicAppTlsEffect')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https",
        "policyDefinitionReferenceId": "Deny-LogicApp-Without-Https",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('logicAppHttpsEffect')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fa3a6357-c6d6-4120-8429-855577ec0063",
        "policyDefinitionReferenceId": "Dine-Function-Apps-Slots-Tls",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('functionAppSlotsTls')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae44c1d1-0df2-4ca9-98fa-a3d3ae5b409d",
        "policyDefinitionReferenceId": "Dine-AppService-Apps-Tls",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('appServiceAppsTls')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
        "policyDefinitionReferenceId": "Deny-AppService-Apps-Https",
        "definitionVersion": "4.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('appServiceAppsHttps')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6545c6b-dd9d-4265-91e6-0b451e2f1c50",
        "policyDefinitionReferenceId": "Deny-AppService-Tls",
        "definitionVersion": "2.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('appServiceTls')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/014664e7-e348-41a3-aeb9-566e4ff6a9df",
        "policyDefinitionReferenceId": "DINE-AppService-AppSlotTls",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('appServiceAppSlotTls')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e5dbe3f-2702-4ffc-8b1e-0cae008a5c71",
        "policyDefinitionReferenceId": "Deny-FuncAppSlots-Https",
        "definitionVersion": "2.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('functionAppSlotsHttps')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
        "policyDefinitionReferenceId": "Deny-FunctionApp-Https",
        "definitionVersion": "5.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('functionAppHttps')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae1b9a8c-dfce-4605-bd91-69213b4a26fc",
        "policyDefinitionReferenceId": "Deny-AppService-Slots-Https",
        "definitionVersion": "2.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('appServiceAppSlotsHttps')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS",
        "policyDefinitionReferenceId": "Deny-EH-minTLS",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('eventHubMinTls')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8793640-60f7-487c-b5c3-1d37215905c4",
        "policyDefinitionReferenceId": "Deny-Sql-Managed-Tls-Version",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('sqlManagedTlsVersion')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
        "policyDefinitionReferenceId": "Deny-Sql-Db-Tls",
        "definitionVersion": "2.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('sqlDbTls')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
        "policyDefinitionReferenceId": "Deny-Storage-Tls",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('storageAccountsTls')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cb3738a6-82a2-4a18-b87b-15217b9deff4",
        "policyDefinitionReferenceId": "Deny-Synapse-Tls-Version",
        "definitionVersion": "1.*.*",
        "groupNames": [],
        "parameters": {
          "effect": {
            "value": "[[parameters('synapseTlsVersion')]"
          }
        }
      }
    ],
    "policyDefinitionGroups": null
  }
}
,
{
    "name": "Enforce-Encryption-CMK",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "[Deprecated]: Deny or Audit resources without Encryption with a customer-managed key (CMK)",
        "description": "Deny or Audit resources without Encryption with a customer-managed key (CMK). Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-Encryption-CMK_20250218.html",
        "metadata": {
            "version": "3.2.0-deprecated",
            "deprecated": true,
            "supersededBy": "Enforce-Encryption-CMK_20250218",
            "category": "Encryption",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud"
            ]
        },
        "parameters": {
            "ACRCmkEffect": {
                "metadata": {
                    "displayName": "Container registries should be encrypted with a customer-managed key (CMK)",
                    "description": "Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/acr/CMK."
                },
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "AksCmkEffect": {
                "metadata": {
                    "displayName": "Azure Kubernetes Service clusters both operating systems and data disks should be encrypted by customer-managed keys",
                    "description": "Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards."
                },
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "WorkspaceCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)",
                    "description": "Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys (CMK). By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/azureml-workspaces-cmk."
                }
            },
            "CognitiveServicesCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)",
                    "description": "Customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk."
                }
            },
            "CosmosCMKEffect": {
                "type": "String",
                "defaultValue": "deny",
                "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                ],
                "metadata": {
                    "displayName": "Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest",
                    "description": "Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk."
                }
            },
            "DataBoxCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password",
                    "description": "Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key."
                }
            },
            "StreamAnalyticsCMKEffect": {
                "type": "String",
                "defaultValue": "deny",
                "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                ],
                "metadata": {
                    "displayName": "Azure Stream Analytics jobs should use customer-managed keys to encrypt data",
                    "description": "Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted."
                }
            },
            "SynapseWorkspaceCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
                    "description": "Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys."
                }
            },
            "StorageCMKEffect": {
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Storage accounts should use customer-managed key (CMK) for encryption, no deny as this would result in not able to create storage account because the first need of MSI for encryption",
                    "description": "Secure your storage account with greater flexibility using customer-managed keys (CMKs). When you specify a CMK, that key is used to protect and control access to the key that encrypts your data. Using CMKs provides additional capabilities to control rotation of the key encryption key or cryptographically erase data."
                }
            },
            "MySQLCMKEffect": {
                "type": "String",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure MySQL servers bring your own key data protection should be enabled",
                    "description": "Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management."
                }
            },
            "PostgreSQLCMKEffect": {
                "type": "String",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure PostgreSQL servers bring your own key data protection should be enabled",
                    "description": "Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management."
                }
            },
            "SqlServerTDECMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "SQL servers should use customer-managed keys to encrypt data at rest",
                    "description": "Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement."
                }
            },
            "HealthcareAPIsCMKEffect": {
                "type": "String",
                "defaultValue": "audit",
                "allowedValues": [
                    "audit",
                    "disabled"
                ],
                "metadata": {
                    "displayName": "Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest",
                    "description": "Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys."
                }
            },
            "AzureBatchCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Batch account should use customer-managed keys to encrypt data",
                    "description": "Use customer-managed keys (CMKs) to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/Batch-CMK."
                }
            },
            "EncryptedVMDisksEffect": {
                "type": "String",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Disk encryption should be applied on virtual machines",
                    "description": "Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations."
                }
            },
            "AutomationAccountCmkEffect": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "BackupCmkEffect": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveSearchCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "osAndDataDiskCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerInstanceCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adxCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adfCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventHubNamespacesCmk": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "eventHubPremiumCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "serviceBusDenyCmk": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "sqlManagedCmk": {
              "type": "string",
              "defaultValue": "Deny",
              "allowedValues": [
                  "Audit",
                  "Deny",
                  "Disabled"
              ]
            },
            "storageTableCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsEncryptionCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageQueueCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "botServiceCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "audit",
                    "Deny",
                    "deny",
                    "Disabled",
                    "disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "ACRCmkDeny",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('ACRCmkEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AksCmkDeny",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AksCmkEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "WorkspaceCMK",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('WorkspaceCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "CognitiveServicesCMK",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('CognitiveServicesCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "CosmosCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('CosmosCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "DataBoxCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('DataBoxCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "StreamAnalyticsCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('StreamAnalyticsCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SynapseWorkspaceCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SynapseWorkspaceCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "StorageCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('StorageCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "MySQLCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('MySQLCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "PostgreSQLCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('PostgreSQLCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SqlServerTDECMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SqlServerTDECMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "HealthcareAPIsCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('HealthcareAPIsCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AzureBatchCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureBatchCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "EncryptedVMDisksEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('EncryptedVMDisksEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/56a5ee18-2ae6-4810-86f7-18e39ce5629b",
                "policyDefinitionReferenceId": "Deny-Aa-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AutomationAccountCmkEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2e94d99a-8a36-4563-bc77-810d8893b671",
                "policyDefinitionReferenceId": "Deny-Backup-Cmk",
                "definitionVersion": "1.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('BackupCmkEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/76a56461-9dc0-40f0-82f5-2453283afa2f",
                "policyDefinitionReferenceId": "Deny-CognitiveSearch-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveSearchCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/702dd420-7fcc-42c5-afe8-4026edd20fe0",
                "policyDefinitionReferenceId": "Deny-OsAndDataDisk-Cmk",
                "definitionVersion": "3.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('osAndDataDiskCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0aa61e00-0a01-4a3c-9945-e93cffedf0e6",
                "policyDefinitionReferenceId": "Deny-ContainerInstance-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerInstanceCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/81e74cea-30fd-40d5-802f-d72103c2aaaa",
                "policyDefinitionReferenceId": "Deny-ADX-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adxCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4ec52d6d-beb7-40c4-9a9e-fe753254690e",
                "policyDefinitionReferenceId": "Deny-Adf-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adfCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a1ad735a-e96f-45d2-a7b2-9a4932cab7ec",
                "policyDefinitionReferenceId": "Deny-EH-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubNamespacesCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-Premium-CMK",
                "policyDefinitionReferenceId": "Deny-EH-Premium-CMK",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubPremiumCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/295fc8b1-dc9f-4f53-9c61-3f313ceab40a",
                "policyDefinitionReferenceId": "Deny-Sb-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('serviceBusDenyCmk')]"
                    }
                }
            },
            {
              "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2",
              "policyDefinitionReferenceId": "Deny-Sql-Managed-Cmk",
              "definitionVersion": "2.*.*",
              "groupNames": [],
              "parameters": {
                  "effect": {
                      "value": "[[parameters('sqlManagedCmk')]"
                  }
              }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7c322315-e26d-4174-a99e-f49d351b4688",
                "policyDefinitionReferenceId": "Deny-Storage-Table-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageTableCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b5ec538c-daa0-4006-8596-35468b9148e8",
                "policyDefinitionReferenceId": "Deny-Storage-Encryption-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsEncryptionCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e5abd0-2554-4736-b7c0-4ffef23475ef",
                "policyDefinitionReferenceId": "Deny-Storage-Queue-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageQueueCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/51522a96-0869-4791-82f3-981000c2c67f",
                "policyDefinitionReferenceId": "Deny-BotService-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('botServiceCmk')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
}
,
{
    "name": "Enforce-Encryption-CMK_20250218",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
        "description": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
        "metadata": {
            "version": "1.1.0",
            "category": "Encryption",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "replacesPolicy": "Enforce-Encryption-CMK",
            "alzCloudEnvironments": [
                "AzureCloud"
            ]
        },
        "parameters": {
            "ACRCmkEffect": {
                "metadata": {
                    "displayName": "Container registries should be encrypted with a customer-managed key (CMK)",
                    "description": "Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/acr/CMK."
                },
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "AksCmkEffect": {
                "metadata": {
                    "displayName": "Azure Kubernetes Service clusters both operating systems and data disks should be encrypted by customer-managed keys",
                    "description": "Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards."
                },
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "WorkspaceCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)",
                    "description": "Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys (CMK). By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/azureml-workspaces-cmk."
                }
            },
            "CognitiveServicesCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)",
                    "description": "Customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk."
                }
            },
            "CosmosCMKEffect": {
                "type": "String",
                "defaultValue": "deny",
                "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                ],
                "metadata": {
                    "displayName": "Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest",
                    "description": "Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk."
                }
            },
            "DataBoxCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password",
                    "description": "Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key."
                }
            },
            "StreamAnalyticsCMKEffect": {
                "type": "String",
                "defaultValue": "deny",
                "allowedValues": [
                    "audit",
                    "deny",
                    "disabled"
                ],
                "metadata": {
                    "displayName": "Azure Stream Analytics jobs should use customer-managed keys to encrypt data",
                    "description": "Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted."
                }
            },
            "SynapseWorkspaceCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
                    "description": "Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys."
                }
            },
            "StorageCMKEffect": {
                "type": "String",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Storage accounts should use customer-managed key (CMK) for encryption, no deny as this would result in not able to create storage account because the first need of MSI for encryption",
                    "description": "Secure your storage account with greater flexibility using customer-managed keys (CMKs). When you specify a CMK, that key is used to protect and control access to the key that encrypts your data. Using CMKs provides additional capabilities to control rotation of the key encryption key or cryptographically erase data."
                }
            },
            "MySQLCMKEffect": {
                "type": "String",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure MySQL servers bring your own key data protection should be enabled",
                    "description": "Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management."
                }
            },
            "PostgreSQLCMKEffect": {
                "type": "String",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure PostgreSQL servers bring your own key data protection should be enabled",
                    "description": "Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management."
                }
            },
            "SqlServerTDECMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "SQL servers should use customer-managed keys to encrypt data at rest",
                    "description": "Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement."
                }
            },
            "HealthcareAPIsCMKEffect": {
                "type": "String",
                "defaultValue": "audit",
                "allowedValues": [
                    "audit",
                    "disabled"
                ],
                "metadata": {
                    "displayName": "Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest",
                    "description": "Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys."
                }
            },
            "AzureBatchCMKEffect": {
                "type": "String",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Azure Batch account should use customer-managed keys to encrypt data",
                    "description": "Use customer-managed keys (CMKs) to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/Batch-CMK."
                }
            },
            "EncryptedVMDisksEffect": {
                "type": "String",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ],
                "metadata": {
                    "displayName": "Disk encryption should be applied on virtual machines",
                    "description": "Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations."
                }
            },
            "AutomationAccountCmkEffect": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "BackupCmkEffect": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveSearchCmk": {
                "type": "string",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ]
            },
            "osAndDataDiskCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerInstanceCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adxCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adfCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventHubNamespacesCmk": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "eventHubPremiumCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "serviceBusDenyCmk": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "sqlManagedCmk": {
              "type": "string",
              "defaultValue": "Deny",
              "allowedValues": [
                  "Audit",
                  "Deny",
                  "Disabled"
              ]
            },
            "storageTableCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsEncryptionCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageQueueCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "botServiceCmk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "audit",
                    "Deny",
                    "deny",
                    "Disabled",
                    "disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "ACRCmkDeny",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('ACRCmkEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AksCmkDeny",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AksCmkEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "WorkspaceCMK",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('WorkspaceCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "CognitiveServicesCMK",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('CognitiveServicesCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "CosmosCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('CosmosCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "DataBoxCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('DataBoxCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "StreamAnalyticsCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('StreamAnalyticsCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SynapseWorkspaceCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SynapseWorkspaceCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "StorageCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('StorageCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "MySQLCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('MySQLCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "PostgreSQLCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('PostgreSQLCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "SqlServerTDECMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('SqlServerTDECMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "HealthcareAPIsCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('HealthcareAPIsCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "AzureBatchCMKEffect",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AzureBatchCMKEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "EncryptedVMDisksEffectWin",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3dc5edcd-002d-444c-b216-e123bbfa37c0",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('EncryptedVMDisksEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "EncryptedVMDisksEffectLin",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ca88aadc-6e2b-416c-9de2-5a0f01d1693f",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('EncryptedVMDisksEffect')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/56a5ee18-2ae6-4810-86f7-18e39ce5629b",
                "policyDefinitionReferenceId": "Deny-Aa-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('AutomationAccountCmkEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2e94d99a-8a36-4563-bc77-810d8893b671",
                "policyDefinitionReferenceId": "Deny-Backup-Cmk",
                "definitionVersion": "1.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('BackupCmkEffect')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/76a56461-9dc0-40f0-82f5-2453283afa2f",
                "policyDefinitionReferenceId": "Deny-CognitiveSearch-Cmk",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveSearchCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/702dd420-7fcc-42c5-afe8-4026edd20fe0",
                "policyDefinitionReferenceId": "Deny-OsAndDataDisk-Cmk",
                "definitionVersion": "3.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('osAndDataDiskCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0aa61e00-0a01-4a3c-9945-e93cffedf0e6",
                "policyDefinitionReferenceId": "Deny-ContainerInstance-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerInstanceCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/81e74cea-30fd-40d5-802f-d72103c2aaaa",
                "policyDefinitionReferenceId": "Deny-ADX-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adxCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4ec52d6d-beb7-40c4-9a9e-fe753254690e",
                "policyDefinitionReferenceId": "Deny-Adf-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adfCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a1ad735a-e96f-45d2-a7b2-9a4932cab7ec",
                "policyDefinitionReferenceId": "Deny-EH-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubNamespacesCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-Premium-CMK",
                "policyDefinitionReferenceId": "Deny-EH-Premium-CMK",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubPremiumCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/295fc8b1-dc9f-4f53-9c61-3f313ceab40a",
                "policyDefinitionReferenceId": "Deny-Sb-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('serviceBusDenyCmk')]"
                    }
                }
            },
            {
              "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2",
              "policyDefinitionReferenceId": "Deny-Sql-Managed-Cmk",
              "definitionVersion": "2.*.*",
              "groupNames": [],
              "parameters": {
                  "effect": {
                      "value": "[[parameters('sqlManagedCmk')]"
                  }
              }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7c322315-e26d-4174-a99e-f49d351b4688",
                "policyDefinitionReferenceId": "Deny-Storage-Table-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageTableCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b5ec538c-daa0-4006-8596-35468b9148e8",
                "policyDefinitionReferenceId": "Deny-Storage-Encryption-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsEncryptionCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e5abd0-2554-4736-b7c0-4ffef23475ef",
                "policyDefinitionReferenceId": "Deny-Storage-Queue-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageQueueCmk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/51522a96-0869-4791-82f3-981000c2c67f",
                "policyDefinitionReferenceId": "Deny-BotService-Cmk",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('botServiceCmk')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
}
,
{
    "name": "Enforce-Guardrails-APIM",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for API Management",
        "description": "This policy initiative is a group of policies that ensures API Management is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "API Management",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "apiSubscriptionScope": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "minimumApiVersion": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "apimSkuVnet": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "apimDisablePublicNetworkAccess": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "apimApiBackendCertValidation": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "apimDirectApiEndpoint": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "apimCallApiAuthn": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "apimEncryptedProtocols": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "apimVnetUsage": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "apimSecrets": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "apimTls": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249",
                "policyDefinitionReferenceId": "Deny-Apim-without-Kv",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimSecrets')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
                "policyDefinitionReferenceId": "Deny-Apim-without-Vnet",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimVnetUsage')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-APIM-TLS",
                "policyDefinitionReferenceId": "Deny-APIM-TLS",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimTls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
                "policyDefinitionReferenceId": "Deny-Apim-Protocols",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimEncryptedProtocols')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
                "policyDefinitionReferenceId": "Deny-Apim-Authn",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimCallApiAuthn')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b741306c-968e-4b67-b916-5675e5c709f4",
                "policyDefinitionReferenceId": "Deny-Apim-Direct-Endpoint",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimDirectApiEndpoint')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4",
                "policyDefinitionReferenceId": "Deny-Apim-Cert-Validation",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimApiBackendCertValidation')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7ca8c8ac-3a6e-493d-99ba-c5fa35347ff2",
                "policyDefinitionReferenceId": "Dine-Apim-Public-NetworkAccess",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimDisablePublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/73ef9241-5d81-4cd4-b483-8443d1730fe5",
                "policyDefinitionReferenceId": "Deny-Apim-Sku-Vnet",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apimSkuVnet')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/549814b6-3212-4203-bdc8-1548d342fb67",
                "policyDefinitionReferenceId": "Deny-Apim-Version",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('minimumApiVersion')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3aa03346-d8c5-4994-a5bc-7652c2a2aef1",
                "policyDefinitionReferenceId": "Deny-Api-subscription-scope",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('apiSubscriptionScope')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-AppServices",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for App Service",
        "description": "This policy initiative is a group of policies that ensures App Service is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "App Service",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "functionAppDebugging": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "appServiceDisableLocalAuth": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "appServiceSkuPl": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceDisableLocalAuthFtp": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "appServiceRouting": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceScmAuth": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "appServiceRfc": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceAppsRfc": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceAppsVnetRouting": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceEnvLatestVersion": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appServiceAppSlotsRemoteDebugging": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "appServiceAppsRemoteDebugging": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "appServiceByoc": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "functionAppSlotsModifyHttps": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "appServiceAppHttps": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "functionAppSlotsModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "appServiceAppsModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "appServiceAppModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppService-without-BYOC",
                "policyDefinitionReferenceId": "Deny-AppService-Byoc",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceByoc')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a5e3fe8f-f6cd-4f1d-bbf6-c749754a724b",
                "policyDefinitionReferenceId": "Dine-AppService-Apps-Remote-Debugging",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppsRemoteDebugging')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cca5adfe-626b-4cc6-8522-f5b6ed2391bd",
                "policyDefinitionReferenceId": "Deny-AppService-Slots-Remote-Debugging",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppSlotsRemoteDebugging')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb4d34ab-0929-491c-bbf3-61e13da19f9a",
                "policyDefinitionReferenceId": "Deny-AppService-Latest-Version",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceEnvLatestVersion')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/801543d1-1953-4a90-b8b0-8cf6d41473a5",
                "policyDefinitionReferenceId": "Deny-AppService-Vnet-Routing",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppsVnetRouting')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f5c0bfb3-acea-47b1-b477-b0edcdf6edc1",
                "policyDefinitionReferenceId": "Deny-AppService-Rfc",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceRfc')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a691eacb-474d-47e4-b287-b4813ca44222",
                "policyDefinitionReferenceId": "Deny-AppServiceApps-Rfc",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppsRfc')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/70adbb40-e092-42d5-a6f8-71c540a5efdb",
                "policyDefinitionReferenceId": "DINE-FuncApp-Debugging",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('functionAppDebugging')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e97b776-f380-4722-a9a3-e7f0be029e79",
                "policyDefinitionReferenceId": "DINE-AppService-ScmAuth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceScmAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5747353b-1ca9-42c1-a4dd-b874b894f3d4",
                "policyDefinitionReferenceId": "Deny-AppServ-Routing",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceRouting')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/572e342c-c920-4ef5-be2e-1ed3c6a51dc5",
                "policyDefinitionReferenceId": "Deny-AppServ-FtpAuth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceDisableLocalAuthFtp')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/546fe8d2-368d-4029-a418-6af48a7f61e5",
                "policyDefinitionReferenceId": "Deny-AppServ-SkuPl",
                "definitionVersion": "4.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceSkuPl')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2c034a29-2a5f-4857-b120-f800fe5549ae",
                "policyDefinitionReferenceId": "DINE-AppService-LocalAuth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceDisableLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/25a5046c-c423-4805-9235-e844ae9ef49b",
                "policyDefinitionReferenceId": "DINE-AppService-Debugging",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('functionAppDebugging')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/08cf2974-d178-48a0-b26d-f6b8e555748b",
                "policyDefinitionReferenceId": "Modify-Function-Apps-Slots-Https",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('functionAppSlotsModifyHttps')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0f98368e-36bc-4716-8ac2-8f8067203b63",
                "policyDefinitionReferenceId": "Modify-AppService-Https",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppHttps')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/242222f3-4985-4e99-b5ef-086d6a6cb01c",
                "policyDefinitionReferenceId": "Modify-Function-Apps-Slots-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('functionAppSlotsModifyPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2374605e-3e0b-492b-9046-229af202562c",
                "policyDefinitionReferenceId": "Modify-AppService-Apps-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppsModifyPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c6c3e00e-d414-4ca4-914f-406699bb8eee",
                "policyDefinitionReferenceId": "Modify-AppService-App-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appServiceAppModifyPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-Automation",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Automation Account",
        "description": "This policy initiative is a group of policies that ensures Automation Account is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Automation",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "aaModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "aaVariablesEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "aaLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "aaManagedIdentity": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "autoHotPatch": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Disabled",
                    "Deny"
                ]
            },
            "aaModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d02d2f7-e38b-4bdc-96f3-adc0a8726abc",
                "policyDefinitionReferenceId": "Deny-Windows-Vm-HotPatch",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('autoHotPatch')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dea83a72-443c-4292-83d5-54a2f98749c0",
                "policyDefinitionReferenceId": "Deny-Aa-Managed-Identity",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aaManagedIdentity')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/48c5f1cb-14ad-4797-8e3b-f78ab3f8d700",
                "policyDefinitionReferenceId": "Deny-Aa-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aaLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
                "policyDefinitionReferenceId": "Deny-Aa-Variables-Encrypt",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aaVariablesEncryption')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/30d1d58e-8f96-47a5-8564-499a3f3cca81",
                "policyDefinitionReferenceId": "Modify-Aa-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aaModifyLocalAUth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/23b36a7c-9d26-4288-a8fd-c1d2fa284d8c",
                "policyDefinitionReferenceId": "Modify-Aa-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aaModifyPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-BotService",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Bot Service",
        "description": "This policy initiative is a group of policies that ensures Bot Service is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Bot Service",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "botServiceValidUri": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "audit",
                    "Deny",
                    "deny",
                    "Disabled",
                    "disabled"
                ]
            },
            "botServiceIsolatedMode": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "audit",
                    "Deny",
                    "deny",
                    "Disabled",
                    "disabled"
                ]
            },
            "botServiceLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "botServicePrivateLink": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6164527b-e1ee-4882-8673-572f425f5e0a",
                "policyDefinitionReferenceId": "Deny-BotService-Valid-Uri",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('botServiceValidUri')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/52152f42-0dda-40d9-976e-abb1acdd611e",
                "policyDefinitionReferenceId": "Deny-BotService-Isolated-Mode",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('botServiceIsolatedMode')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ffea632e-4e3a-4424-bf78-10e179bb2e1a",
                "policyDefinitionReferenceId": "Deny-BotService-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('botServiceLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ad5621d6-a877-4407-aa93-a950b428315e",
                "policyDefinitionReferenceId": "Audit-BotService-Private-Link",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('botServicePrivateLink')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-CognitiveServices",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Cognitive Services",
        "description": "This policy initiative is a group of policies that ensures Cognitive Services is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.2.0",
            "category": "Cognitive Services",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "cognitiveSearchSku": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveSearchLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "modifyCognitiveSearchLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "cognitiveServicesLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "modifyCognitiveSearchPublicEndpoint": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "cognitiveServicesModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "cognitiveServicesManagedIdentity": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveServicesCustomerStorage": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveServicesResourceLogs": {
                "type": "string",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a049bf77-880b-470f-ba6d-9f21c530cf83",
                "policyDefinitionReferenceId": "Deny-CognitiveSearch-SKU",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveSearchSku')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6300012e-e9a4-4649-b41f-a85f5c43be91",
                "policyDefinitionReferenceId": "Deny-CongitiveSearch-LocalAuth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveSearchLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4eb216f2-9dba-4979-86e6-5d7e63ce3b75",
                "policyDefinitionReferenceId": "Modify-CogntiveSearch-LocalAuth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifyCognitiveSearchLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9cee519f-d9c1-4fd9-9f79-24ec3449ed30",
                "policyDefinitionReferenceId": "Modify-CogntiveSearch-PublicEndpoint",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifyCognitiveSearchPublicEndpoint')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/47ba1dd7-28d9-4b07-a8d5-9813bed64e0c",
                "policyDefinitionReferenceId": "Modify-Cognitive-Services-Public-Network-Access",
                "definitionVersion": "3.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesModifyPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe3fd216-4f83-4fc1-8984-2bbec80a3418",
                "policyDefinitionReferenceId": "Deny-Cognitive-Services-Managed-Identity",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesManagedIdentity')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/46aa9b05-0e60-4eae-a88b-1e9d374fa515",
                "policyDefinitionReferenceId": "Deny-Cognitive-Services-Customer-Storage",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesCustomerStorage')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/14de9e63-1b31-492e-a5a3-c3f7fd57f555",
                "policyDefinitionReferenceId": "Modify-Cognitive-Services-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4",
                "policyDefinitionReferenceId": "Aine-Cognitive-Services-Resource-Logs",
                "definitionVersion": "5.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesResourceLogs')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-Compute",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Compute",
        "description": "This policy initiative is a group of policies that ensures Compute is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Compute",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "diskDoubleEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "vmAndVmssEncryptionHost": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87",
                "policyDefinitionReferenceId": "Deny-VmAndVmss-Encryption-Host",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('vmAndVmssEncryptionHost')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ca91455f-eace-4f96-be59-e6e2c35b4816",
                "policyDefinitionReferenceId": "Deny-Disk-Double-Encryption",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('diskDoubleEncryption')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-ContainerApps",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Container Apps",
        "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Container Apps",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "containerAppsManagedIdentity": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerAppsVnetInjection": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8b346db6-85af-419b-8557-92cee2c0f9bb",
                "policyDefinitionReferenceId": "Deny-ContainerApp-Vnet-Injection",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerAppsVnetInjection')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b874ab2d-72dd-47f1-8cb5-4a306478a4e7",
                "policyDefinitionReferenceId": "Deny-ContainerApps-Managed-Identity",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerAppsManagedIdentity')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-ContainerInstance",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Container Instance",
        "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Container Instances",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "containerInstanceVnet": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8af8f826-edcb-4178-b35f-851ea6fea615",
                "policyDefinitionReferenceId": "Deny-ContainerInstance-Vnet",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerInstanceVnet')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-ContainerRegistry",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Container Registry",
        "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Container Registry",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "containerRegistryUnrestrictedNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerRegistryRepositoryToken": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerRegistryModifyRepositoryToken": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "containerRegistryLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerRegistryModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "containerRegistryExports": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerRegistryAnAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerRegistryModifyAnAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "containerRegistrySkuPrivateLink": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerRegistryArmAudience": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "containerRegistryModifyArmAudience": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "containerRegistryModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/79fdfe03-ffcb-4e55-b4d0-b925b8241759",
                "policyDefinitionReferenceId": "Modify-ContainerRegistry-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryModifyLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a9b426fe-8856-4945-8600-18c5dd1cca2a",
                "policyDefinitionReferenceId": "Modify-ContainerRegistry-Repo-Token",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryModifyRepositoryToken')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/42781ec6-6127-4c30-bdfa-fb423a0047d3",
                "policyDefinitionReferenceId": "Deny-ContainerRegistry-Arm-Audience",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryArmAudience')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/785596ed-054f-41bc-aaec-7f3d0ba05725",
                "policyDefinitionReferenceId": "Modify-ContainerRegistry-Arm-Audience",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryModifyArmAudience')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bd560fc0-3c69-498a-ae9f-aa8eb7de0e13",
                "policyDefinitionReferenceId": "Deny-ContainerRegistry-Sku-PrivateLink",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistrySkuPrivateLink')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cced2946-b08a-44fe-9fd9-e4ed8a779897",
                "policyDefinitionReferenceId": "Modify-ContainerRegistry-Anonymous-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryModifyAnAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9f2dea28-e834-476c-99c5-3507b4728395",
                "policyDefinitionReferenceId": "Deny-ContainerRegistry-Anonymous-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryAnAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/524b0254-c285-4903-bee6-bb8126cde579",
                "policyDefinitionReferenceId": "Deny-ContainerRegistry-Exports",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryExports')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dc921057-6b28-4fbe-9b83-f7bec05db6c2",
                "policyDefinitionReferenceId": "Deny-ContainerRegistry-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ff05e24e-195c-447e-b322-5e90c9f9f366",
                "policyDefinitionReferenceId": "Deny-ContainerRegistry-Repo-Token",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryRepositoryToken')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
                "policyDefinitionReferenceId": "Deny-ContainerRegistry-Unrestricted-Network-Access",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryUnrestrictedNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a3701552-92ea-433e-9d17-33b7f1208fc9",
                "policyDefinitionReferenceId": "Modify-ContainerRegistry-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('containerRegistryModifyPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-CosmosDb",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Cosmos DB",
        "description": "This policy initiative is a group of policies that ensures Cosmos DB is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Cosmos DB",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "cosmosDbLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cosmosDbFwRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cosmosDbAtp": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "cosmosDbModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "cosmosDbModifyPublicAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dc2d41d1-4ab1-4666-a3e1-3d51c43e0049",
                "policyDefinitionReferenceId": "Modify-CosmosDb-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cosmosDbModifyLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b5f04e03-92a3-4b09-9410-2cc5e5047656",
                "policyDefinitionReferenceId": "Dine-CosmosDb-Atp",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cosmosDbAtp')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
                "policyDefinitionReferenceId": "Deny-CosmosDb-Fw-Rules",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cosmosDbFwRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
                "policyDefinitionReferenceId": "Deny-CosmosDb-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cosmosDbLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4750c32b-89c0-46af-bfcb-2e4541a818d5",
                "policyDefinitionReferenceId": "Append-CosmosDb-Metadata",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {}
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/da69ba51-aaf1-41e5-8651-607cd0b37088",
                "policyDefinitionReferenceId": "Modify-CosmosDb-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cosmosDbModifyPublicAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-DataExplorer",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Data Explorer",
        "description": "This policy initiative is a group of policies that ensures Data Explorer is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Azure Data Explorer",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "adxEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adxDoubleEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adxSku": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adxModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1fec9658-933f-4b3e-bc95-913ed22d012b",
                "policyDefinitionReferenceId": "Deny-ADX-Sku-without-PL-Support",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adxSku')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ec068d99-e9c7-401f-8cef-5bdde4e6ccf1",
                "policyDefinitionReferenceId": "Deny-ADX-Double-Encryption",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adxDoubleEncryption')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f4b53539-8df9-40e4-86c6-6b607703bd4e",
                "policyDefinitionReferenceId": "Deny-ADX-Encryption",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adxEncryption')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7b32f193-cb28-4e15-9a98-b9556db0bafa",
                "policyDefinitionReferenceId": "Modify-ADX-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adxModifyPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-DataFactory",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Data Factory",
        "description": "This policy initiative is a group of policies that ensures Data Factory is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Data Factory",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "adfSqlIntegration": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adfLinkedServiceKeyVault": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adfGit": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adfManagedIdentity": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "adfModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f78ccdb4-7bf4-4106-8647-270491d2978a",
                "policyDefinitionReferenceId": "Deny-Adf-Managed-Identity",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adfManagedIdentity')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/77d40665-3120-4348-b539-3192ec808307",
                "policyDefinitionReferenceId": "Deny-Adf-Git",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adfGit')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/127ef6d7-242f-43b3-9eef-947faf1725d0",
                "policyDefinitionReferenceId": "Deny-Adf-Linked-Service-Key-Vault",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adfLinkedServiceKeyVault')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0088bc63-6dee-4a9c-9d29-91cfdc848952",
                "policyDefinitionReferenceId": "Deny-Adf-Sql-Integration",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adfSqlIntegration')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/08b1442b-7789-4130-8506-4f99a97226a7",
                "policyDefinitionReferenceId": "Modify-Adf-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('adfModifyPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-EventGrid",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Event Grid",
        "description": "This policy initiative is a group of policies that ensures Event Grid is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Event Grid",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "eventGridLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventGridPartnerNamespaceLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventGridPartnerNamespaceModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "eventGridTopicLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventGridTopicModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "eventGridDomainModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "eventGridDomainModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "eventGridTopicModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2dd0e8b9-4289-4bb0-b813-1883298e9924",
                "policyDefinitionReferenceId": "Modify-EventGrid-Partner-Namespace-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridPartnerNamespaceModifyLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8ac2748f-3bf1-4c02-a3b6-92ae68cf75b1",
                "policyDefinitionReferenceId": "Modify-EventGrid-Domain-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridDomainModifyLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae9fb87f-8a17-4428-94a4-8135d431055c",
                "policyDefinitionReferenceId": "Deny-EventGrid-Topic-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridTopicLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c8144d9-746a-4501-b08c-093c8d29ad04",
                "policyDefinitionReferenceId": "Modify-EventGrid-Topic-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridTopicModifyLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8632b003-3545-4b29-85e6-b2b96773df1e",
                "policyDefinitionReferenceId": "Deny-EventGrid-Partner-Namespace-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridPartnerNamespaceLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8bfadddb-ee1c-4639-8911-a38cb8e0b3bd",
                "policyDefinitionReferenceId": "Deny-EventGrid-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/898e9824-104c-4965-8e0e-5197588fa5d4",
                "policyDefinitionReferenceId": "Modify-EventGrid-Domain-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridDomainModifyPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/36ea4b4b-0f7f-4a54-89fa-ab18f555a172",
                "policyDefinitionReferenceId": "Modify-EventGrid-Topic-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventGridTopicModifyPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-EventHub",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Event Hub",
        "description": "This policy initiative is a group of policies that ensures Event Hub is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Event Hub",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "eventHubAuthRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventHubNamespacesLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "eventHubNamespacesModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "eventHubNamespacesDoubleEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/836cd60e-87f3-4e6a-a27c-29d687f01a4c",
                "policyDefinitionReferenceId": "Deny-EH-Double-Encryption",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubNamespacesDoubleEncryption')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/57f35901-8389-40bb-ac49-3ba4f86d889d",
                "policyDefinitionReferenceId": "Modify-EH-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubNamespacesModifyLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5d4e3c65-4873-47be-94f3-6f8b953a3598",
                "policyDefinitionReferenceId": "Deny-EH-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubNamespacesLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7",
                "policyDefinitionReferenceId": "Deny-EH-Auth-Rules",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('eventHubAuthRules')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-KeyVault-Sup",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce additional recommended guardrails for Key Vault",
        "description": "This policy initiative is a group of policies that ensures Key Vault is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Key Vault",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "keyVaultManagedHsmDisablePublicNetworkModify": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "keyVaultModifyFw": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456",
                "policyDefinitionReferenceId": "Modify-KV-PublicNetworkAccess",
                "definitionVersion": "2.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultManagedHsmDisablePublicNetworkModify')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc",
                "policyDefinitionReferenceId": "Modify-KV-Fw",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultModifyFw')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-KeyVault",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Azure Key Vault",
        "description": "Enforce recommended guardrails for Azure Key Vault.",
        "metadata": {
            "version": "2.2.0",
            "category": "Key Vault",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "effectKvSoftDelete": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect - KV Soft Delete",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "effectKvPurgeProtection": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect - KV Purge Protection",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Deny"
            },
            "effectKvSecretsExpire": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect - KV Secrets Expiry",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "effectKvKeysExpire": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect - KV Keys Expiry",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "effectKvFirewallEnabled": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect - KV Firewall Enabled",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "effectKvCertLifetime": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect - KV Certificate Lifetime",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "maximumCertLifePercentageLife": {
                "type": "Integer",
                "metadata": {
                    "displayName": "The maximum lifetime percentage",
                    "description": "Enter the percentage of lifetime of the certificate when you want to trigger the policy action. For example, to trigger a policy action at 80% of the certificate's valid life, enter '80'."
                },
                "defaultValue": 80
            },
            "minimumCertLifeDaysBeforeExpiry": {
                "type": "Integer",
                "metadata": {
                    "displayName": "The minimum days before expiry",
                    "description": "Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'."
                },
                "defaultValue": 90
            },
            "effectKvKeysLifetime": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect - KV Keys Lifetime",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "minimumKeysLifeDaysBeforeExpiry": {
                "type": "Integer",
                "metadata": {
                    "displayName": "The minimum days before expiry",
                    "description": "Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'."
                },
                "defaultValue": 90
            },
            "effectKvSecretsLifetime": {
                "type": "String",
                "metadata": {
                    "displayName": "Effect - KV Secrets Lifetime",
                    "description": "Enable or disable the execution of the policy"
                },
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ],
                "defaultValue": "Audit"
            },
            "minimumSecretsLifeDaysBeforeExpiry": {
                "type": "Integer",
                "metadata": {
                    "displayName": "The minimum days before expiry",
                    "description": "Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'."
                },
                "defaultValue": 90
            },
            "keyVaultCheckMinimumRSACertificateSize": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "keyVaultMinimumRSACertificateSizeValue": {
                "type": "integer",
                "defaultValue": 2048,
                "allowedValues": [
                    2048,
                    3072,
                    4096
                ]
            },
            "keyVaultManagedHsmCheckMinimumRSAKeySize": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultManagedHsmMinimumRSAKeySizeValue": {
                "type": "integer",
                "defaultValue": 2048,
                "allowedValues": [
                    2048,
                    3072,
                    4096
                ]
            },
            "keyVaultCheckMinimumRSAKeySize": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultMinimumRSAKeySizeValue": {
                "type": "integer",
                "defaultValue": 2048,
                "allowedValues": [
                    2048,
                    3072,
                    4096
                ]
            },
            "keyVaultArmRbac": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultHmsPurgeProtection": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultCertificatesPeriod": {
                "type": "string",
                "defaultValue": "Disabled",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "keyVaultCertValidPeriod": {
                "type": "integer",
                "defaultValue": 12
            },
            "keyVaultHmsKeysExpiration": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keysValidPeriod": {
                "type": "string",
                "defaultValue": "Disabled",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keysValidityInDays": {
                "type": "integer",
                "defaultValue": 90
            },
            "secretsValidPeriod": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "secretsValidityInDays": {
                "type": "integer",
                "defaultValue": 90
            },
            "keyVaultCertKeyTypes": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "keyVaultEllipticCurve": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "keyVaultCryptographicType": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keysActive": {
                "type": "string",
                "defaultValue": "Disabled",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keysActiveInDays": {
                "type": "integer",
                "defaultValue": 90
            },
            "keysCurveNames": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "secretsActiveInDays": {
                "type": "integer",
                "defaultValue": 90
            },
            "secretsActive": {
                "type": "string",
                "defaultValue": "Disabled",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultSecretContentType": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultNonIntegratedCa": {
                "type": "string",
                "defaultValue": "Disabled",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "keyVaultNonIntegratedCaValue": {
                "type": "string",
                "defaultValue": "",
                "metadata": {
                    "displayName": "The common name of the certificate authority",
                    "description": "The common name (CN) of the Certificate Authority (CA) provider. For example, for an issuer CN = Contoso, OU = .., DC = .., you can specify Contoso"
                }
            },
            "keyVaultIntegratedCa": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "keyVaultIntegratedCaValue": {
                "type": "array",
                "defaultValue": [
                    "DigiCert",
                    "GlobalSign"
                ]
            },
            "keyVaultHsmMinimumDaysBeforeExpiration": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultHsmMinimumDaysBeforeExpirationValue": {
                "type": "integer",
                "defaultValue": 90
            },
            "keyVaultHmsCurveNames": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "keyVaultHmsCurveNamesValue": {
                "type": "array",
                "defaultValue": [
                    "P-256",
                    "P-256K",
                    "P-384",
                    "P-521"
                ]
            },
            "keyVaultCertificateNotExpireWithinSpecifiedNumberOfDays": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "keyVaultCertificateNotExpireWithinSpecifiedNumberOfDaysValue": {
                "type": "integer",
                "defaultValue": 90
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionReferenceId": "KvSoftDelete",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
                "definitionVersion": "3.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectKvSoftDelete')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "KvPurgeProtection",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectKvPurgeProtection')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "KvSecretsExpire",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectKvSecretsExpire')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "KvKeysExpire",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectKvKeysExpire')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "KvFirewallEnabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
                "definitionVersion": "3.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectKvFirewallEnabled')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "KvCertLifetime",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417",
                "definitionVersion": "2.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectKvCertLifetime')]"
                    },
                    "maximumPercentageLife": {
                        "value": "[[parameters('maximumCertLifePercentageLife')]"
                    },
                    "minimumDaysBeforeExpiry": {
                        "value": "[[parameters('minimumCertLifeDaysBeforeExpiry')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "KvKeysLifetime",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectKvKeysLifetime')]"
                    },
                    "minimumDaysBeforeExpiration": {
                        "value": "[[parameters('minimumKeysLifeDaysBeforeExpiry')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionReferenceId": "KvSecretsLifetime",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a",
                "definitionVersion": "1.*.*",
                "parameters": {
                    "effect": {
                        "value": "[[parameters('effectKvSecretsLifetime')]"
                    },
                    "minimumDaysBeforeExpiration": {
                        "value": "[[parameters('minimumSecretsLifeDaysBeforeExpiry')]"
                    }
                },
                "groupNames": []
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0",
                "policyDefinitionReferenceId": "Deny-KV-RSA-Keys-without-MinCertSize",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultCheckMinimumRSACertificateSize')]"
                    },
                    "minimumRSAKeySize": {
                        "value": "[[parameters('keyVaultMinimumRSACertificateSizeValue')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57",
                "policyDefinitionReferenceId": "Deny-keyVaultManagedHsm-RSA-Keys-without-MinKeySize",
                "definitionVersion": "1.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultManagedHsmCheckMinimumRSAKeySize')]"
                    },
                    "minimumRSAKeySize": {
                        "value": "[[parameters('keyVaultManagedHsmMinimumRSAKeySizeValue')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9",
                "policyDefinitionReferenceId": "Deny-KV-RSA-Keys-without-MinKeySize",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultCheckMinimumRSAKeySize')]"
                    },
                    "minimumRSAKeySize": {
                        "value": "[[parameters('keyVaultMinimumRSAKeySizeValue')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5",
                "policyDefinitionReferenceId": "Deny-KV-without-ArmRbac",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultArmRbac')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383",
                "policyDefinitionReferenceId": "Deny-KV-Hms-PurgeProtection",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultHmsPurgeProtection')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560",
                "policyDefinitionReferenceId": "Deny-KV-Cert-Period",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultCertificatesPeriod')]"
                    },
                    "maximumValidityInMonths": {
                        "value": "[[parameters('keyVaultCertValidPeriod')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5",
                "policyDefinitionReferenceId": "Deny-KV-Hms-Key-Expire",
                "definitionVersion": "1.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultHmsKeysExpiration')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9",
                "policyDefinitionReferenceId": "Deny-KV-Keys-Expire",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keysValidPeriod')]"
                    },
                    "maximumValidityInDays": {
                        "value": "[[parameters('keysValidityInDays')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f",
                "policyDefinitionReferenceId": "Deny-KV-Secrets-ValidityDays",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('secretsValidPeriod')]"
                    },
                    "maximumValidityInDays": {
                        "value": "[[parameters('secretsValidityInDays')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f",
                "policyDefinitionReferenceId": "Deny-KV-Key-Types",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultCertKeyTypes')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf",
                "policyDefinitionReferenceId": "Deny-KV-Elliptic-Curve",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultEllipticCurve')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb",
                "policyDefinitionReferenceId": "Deny-KV-Cryptographic-Type",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultCryptographicType')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9",
                "policyDefinitionReferenceId": "Deny-KV-Key-Active",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keysActive')]"
                    },
                    "maximumValidityInDays": {
                        "value": "[[parameters('keysActiveInDays')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255",
                "policyDefinitionReferenceId": "Deny-KV-Curve-Names",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keysCurveNames')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe",
                "policyDefinitionReferenceId": "Deny-KV-Secret-ActiveDays",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('secretsActive')]"
                    },
                    "maximumValidityInDays": {
                        "value": "[[parameters('secretsActiveInDays')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3",
                "policyDefinitionReferenceId": "Deny-Kv-Secret-Content-Type",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultSecretContentType')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341",
                "policyDefinitionReferenceId": "Deny-Kv-Non-Integrated-Ca",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultNonIntegratedCa')]"
                    },
                    "caCommonName": {
                        "value": "[[parameters('keyVaultNonIntegratedCaValue')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82",
                "policyDefinitionReferenceId": "Deny-Kv-Integrated-Ca",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultIntegratedCa')]"
                    },
                    "allowedCAs": {
                        "value": "[[parameters('keyVaultIntegratedCaValue')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653",
                "policyDefinitionReferenceId": "Deny-Kv-Hsm-MinimumDays-Before-Expiration",
                "definitionVersion": "1.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultHsmMinimumDaysBeforeExpiration')]"
                    },
                    "minimumDaysBeforeExpiration": {
                        "value": "[[parameters('keyVaultHsmMinimumDaysBeforeExpirationValue')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e",
                "policyDefinitionReferenceId": "Deny-Kv-Hsm-Curve-Names",
                "definitionVersion": "1.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultHmsCurveNames')]"
                    },
                    "allowedECNames": {
                        "value": "[[parameters('keyVaultHmsCurveNamesValue')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427",
                "policyDefinitionReferenceId": "Deny-Kv-Cert-Expiration-Within-Specific-Number-Days",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('keyVaultCertificateNotExpireWithinSpecifiedNumberOfDays')]"
                    },
                    "daysToExpire": {
                        "value": "[[parameters('keyVaultCertificateNotExpireWithinSpecifiedNumberOfDaysValue')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-Kubernetes",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Kubernetes",
        "description": "This policy initiative is a group of policies that ensures Kubernetes is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.2.0",
            "category": "Kubernetes",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "aksKms": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "aksCni": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "aksLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "aksPrivateCluster": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "aksPolicy": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "aksCommandInvoke": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "aksReadinessOrLivenessProbes": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "aksPrivContainers": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "aksPrivEscalation": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "aksAllowedCapabilities": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "aksTempDisk": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "aksInternalLb": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "aksDefaultNamespace": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "aksNakedPods": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "aksShareHostProcessAndNamespace": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "audit",
                    "Audit",
                    "deny",
                    "Deny",
                    "disabled",
                    "Disabled"
                ]
            },
            "aksWindowsContainerAdministrator": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5485eac0-7e8f-4964-998b-a44f4f0c1e75",
                "policyDefinitionReferenceId": "Deny-Aks-Windows-Container-Administrator",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksWindowsContainerAdministrator')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8",
                "policyDefinitionReferenceId": "Deny-Aks-Shared-Host-Process-Namespace",
                "definitionVersion": "5.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksShareHostProcessAndNamespace')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/65280eef-c8b4-425e-9aec-af55e55bf581",
                "policyDefinitionReferenceId": "Deny-Aks-Naked-Pods",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksNakedPods')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9f061a12-e40d-4183-a00e-171812443373",
                "policyDefinitionReferenceId": "Deny-Aks-Default-Namespace",
                "definitionVersion": "4.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksDefaultNamespace')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3fc4dc25-5baf-40d8-9b05-7fe74c1bc64e",
                "policyDefinitionReferenceId": "Deny-Aks-Internal-Lb",
                "definitionVersion": "8.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksInternalLb')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/41425d9f-d1a5-499a-9932-f8ed8453932c",
                "policyDefinitionReferenceId": "Deny-Aks-Temp-Disk-Encryption",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksTempDisk')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c26596ff-4d70-4e6a-9a30-c2506bd2f80c",
                "policyDefinitionReferenceId": "Deny-Aks-Allowed-Capabilities",
                "definitionVersion": "6.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksAllowedCapabilities')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
                "policyDefinitionReferenceId": "Deny-Aks-Priv-Escalation",
                "definitionVersion": "7.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksPrivEscalation')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
                "policyDefinitionReferenceId": "Deny-Aks-Priv-Containers",
                "definitionVersion": "9.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksPrivContainers')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b1a9997f-2883-4f12-bdff-2280f99b5915",
                "policyDefinitionReferenceId": "Deny-Aks-ReadinessOrLiveness-Probes",
                "definitionVersion": "3.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksReadinessOrLivenessProbes')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b708b0a-3380-40e9-8b79-821f9fa224cc",
                "policyDefinitionReferenceId": "Dine-Aks-Command-Invoke",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksCommandInvoke')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                "policyDefinitionReferenceId": "Dine-Aks-Policy",
                "definitionVersion": "4.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksPolicy')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                "policyDefinitionReferenceId": "Deny-Aks-Private-Cluster",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksPrivateCluster')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/993c2fcd-2b29-49d2-9eb0-df2c3a730c32",
                "policyDefinitionReferenceId": "Deny-Aks-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dbbdc317-9734-4dd8-9074-993b29c69008",
                "policyDefinitionReferenceId": "Deny-Aks-Kms",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksKms')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/46238e2f-3f6f-4589-9f3f-77bed4116e67",
                "policyDefinitionReferenceId": "Deny-Aks-Cni",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('aksCni')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-MachineLearning",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Machine Learning",
        "description": "This policy initiative is a group of policies that ensures Machine Learning is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.2.0",
            "category": "Machine Learning",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "mlUserAssignedIdentity": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "mlModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "mlLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "mlOutdatedOS": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "mlModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "mlIdleShutdown": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "mlVirtualNetwork": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "mlLegacyMode": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "mlPrivateLink": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "mlResourceLogs": {
                "type": "string",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ]
            },
            "mlAllowedRegistryDeploy": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Deny",
                    "Disabled"
                ]
            },
            "mlAllowedModule": {
                "type": "string",
                "defaultValue": "enforceSetting",
                "allowedValues": [
                    "enforceSetting",
                    "disabled"
                ]
            },
            "mlAllowedPython": {
                "type": "string",
                "defaultValue": "enforceSetting",
                "allowedValues": [
                    "enforceSetting",
                    "disabled"
                ]
            },
            "mlAllowedRegistries": {
                "type": "string",
                "defaultValue": "enforceSetting",
                "allowedValues": [
                    "enforceSetting",
                    "disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f110a506-2dcb-422e-bcea-d533fc8c35e2",
                "policyDefinitionReferenceId": "Deny-ML-Outdated-Os",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effects": {
                        "value": "[[parameters('mlOutdatedOS')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
                "policyDefinitionReferenceId": "Deny-ML-Local-Auth",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6f9a2d0-cff7-4855-83ad-4cd750666512",
                "policyDefinitionReferenceId": "Modify-ML-Local-Auth",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlModifyLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5f0c7d88-c7de-45b8-ac49-db49e72eaa78",
                "policyDefinitionReferenceId": "Deny-ML-User-Assigned-Identity",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlUserAssignedIdentity')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a10ee784-7409-4941-b091-663697637c0f",
                "policyDefinitionReferenceId": "Modify-ML-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlModifyPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/679ddf89-ab8f-48a5-9029-e76054077449",
                "policyDefinitionReferenceId": "Deny-ML-Idle-Shutdown",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlIdleShutdown')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7804b5c7-01dc-4723-969b-ae300cc07ff1",
                "policyDefinitionReferenceId": "Audit-ML-Virtual-Network",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlVirtualNetwork')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e413671a-dd10-4cc1-a943-45b598596cb7",
                "policyDefinitionReferenceId": "Deny-ML-Legacy-Mode",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlLegacyMode')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/45e05259-1eb5-4f70-9574-baf73e9d219b",
                "policyDefinitionReferenceId": "Audit-ML-Private-Link",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlPrivateLink')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/afe0c3be-ba3b-4544-ba52-0c99672a8ad6",
                "policyDefinitionReferenceId": "Aine-ML-Resource-Logs",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlResourceLogs')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/19539b54-c61e-4196-9a38-67598701be90",
                "policyDefinitionReferenceId": "Deny-ML-Allowed-Registry-Deploy",
                "definitionVersion": "1.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlAllowedRegistryDeploy')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/53c70b02-63dd-11ea-bc55-0242ac130003",
                "policyDefinitionReferenceId": "Deny-ML-Allowed-Module",
                "definitionVersion": "6.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlAllowedModule')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/77eeea86-7e81-4a7d-9067-de844d096752",
                "policyDefinitionReferenceId": "Deny-ML-Allowed-Python",
                "definitionVersion": "5.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlAllowedPython')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5853517a-63de-11ea-bc55-0242ac130003",
                "policyDefinitionReferenceId": "Deny-ML-Allowed-Registries",
                "definitionVersion": "6.*.*-preview",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mlAllowedRegistries')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-MySQL",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for MySQL",
        "description": "This policy initiative is a group of policies that ensures MySQL is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "MySQL",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "mySqlInfraEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "mySqlAdvThreatProtection": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/80ed5239-4122-41ed-b54a-6f1fa7552816",
                "policyDefinitionReferenceId": "Dine-MySql-Adv-Threat-Protection",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mySqlAdvThreatProtection')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3a58212a-c829-4f13-9872-6371df2fd0b4",
                "policyDefinitionReferenceId": "Deny-MySql-Infra-Encryption",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('mySqlInfraEncryption')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-Network",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "[Deprecated] Enforce recommended guardrails for Network and Networking services",
        "description": "This policy initiative is a group of policies that ensures Network and Networking services are compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.2.0-deprecated",
            "category": "Network",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "deprecated": true,
            "supersededBy": "Enforce-Guardrails-Network_20250326",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "subnetUdr": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "subnetNsg": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "subnetServiceEndpoint": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appGwWaf": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "vnetModifyDdos": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Audit",
                    "Modify",
                    "Disabled"
                ]
            },
            "ddosPlanResourceId": {
                "type": "string",
                "defaultValue": ""
            },
            "wafMode": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "wafModeRequirement": {
                "type": "string",
                "defaultValue": "Prevention"
            },
            "wafFwRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "wafModeAppGw": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "wafModeAppGwRequirement": {
                "type": "string",
                "defaultValue": "Prevention"
            },
            "denyMgmtFromInternet": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "denyMgmtFromInternetPorts": {
                "type": "Array",
                "metadata": {
                    "displayName": "Ports",
                    "description": "Ports to be blocked"
                },
                "defaultValue": [
                    "22",
                    "3389"
                ]
            },
            "afwEnbaleTlsForAllAppRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "afwEnableTlsInspection": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "afwEmptyIDPSBypassList": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "afwEnableAllIDPSSignatureRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "afwEnableIDPS": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "wafAfdEnabled": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "vpnAzureAD": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appGwTlsVersion": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "modifyUdr": {
                "type": "string",
                "defaultValue": "Disabled"
            },
            "modifyUdrNextHopIpAddress": {
                "type": "string",
                "defaultValue": ""
            },
            "modifyUdrNextHopType": {
                "type": "string",
                "defaultValue": "None"
            },
            "modifyUdrAddressPrefix": {
                "type": "string",
                "defaultValue": "0.0.0.0/0"
            },
            "modifyNsg": {
                "type": "string",
                "defaultValue": "Disabled",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "modifyNsgRuleName": {
                "type": "string",
                "defaultValue": "DenyAnyInternetOutbound"
            },
            "modifyNsgRulePriority": {
                "type": "integer",
                "defaultValue": 1000
            },
            "modifyNsgRuleDirection": {
                "type": "string",
                "defaultValue": "Outbound"
            },
            "modifyNsgRuleAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Allow",
                    "Deny"
                ]
            },
            "modifyNsgRuleProtocol": {
                "type": "string",
                "defaultValue": "*"
            },
            "modifyNsgRuleSourceAddressPrefix": {
                "type": "string",
                "defaultValue": "*"
            },
            "modifyNsgRuleSourcePortRange": {
                "type": "string",
                "defaultValue": "*"
            },
            "modifyNsgRuleDestinationAddressPrefix": {
                "type": "string",
                "defaultValue": "Internet"
            },
            "modifyNsgRuleDestinationPortRange": {
                "type": "string",
                "defaultValue": "*"
            },
            "modifyNsgRuleDescription": {
                "type": "string",
                "defaultValue": "Deny any outbound traffic to the Internet"
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010",
                "policyDefinitionReferenceId": "Deny-Nsg-GW-subnet",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {}
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
                "policyDefinitionReferenceId": "Deny-VPN-AzureAD",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('vpnAzureAD')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
                "policyDefinitionReferenceId": "Deny-Waf-Afd-Enabled",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('wafAfdEnabled')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6484db87-a62d-4327-9f07-80a2cbdf333a",
                "policyDefinitionReferenceId": "Deny-Waf-IDPS",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('afwEnableIDPS')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/610b6183-5f00-4d68-86d2-4ab4cb3a67a5",
                "policyDefinitionReferenceId": "Deny-FW-AllIDPSS",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('afwEnableAllIDPSSignatureRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f516dc7a-4543-4d40-aad6-98f76a706b50",
                "policyDefinitionReferenceId": "Deny-FW-EmpIDPSBypass",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('afwEmptyIDPSBypassList')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/711c24bb-7f18-4578-b192-81a6161e1f17",
                "policyDefinitionReferenceId": "Deny-FW-TLS-Inspection",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('afwEnableTlsInspection')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a58ac66d-92cb-409c-94b8-8e48d7a96596",
                "policyDefinitionReferenceId": "Deny-FW-TLS-AllApp",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('afwEnbaleTlsForAllAppRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12430be1-6cc8-4527-a9a8-e3d38f250096",
                "policyDefinitionReferenceId": "Deny-Waf-AppGw-mode",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('wafModeAppGw')]"
                    },
                    "modeRequirement": {
                        "value": "[[parameters('wafModeAppGwRequirement')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/632d3993-e2c0-44ea-a7db-2eca131f356d",
                "policyDefinitionReferenceId": "Deny-Waf-Fw-rules",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('wafFwRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/425bea59-a659-4cbb-8d31-34499bd030b8",
                "policyDefinitionReferenceId": "Deny-Waf-mode",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('wafMode')]"
                    },
                    "modeRequirement": {
                        "value": "[[parameters('wafModeRequirement')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
                "policyDefinitionReferenceId": "Modify-vNet-DDoS",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('vnetModifyDdos')]"
                    },
                    "ddosPlan": {
                        "value": "[[parameters('ddosPlanResourceId')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
                "policyDefinitionReferenceId": "Deny-Ip-Forwarding",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {}
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
                "policyDefinitionReferenceId": "Deny-vNic-Pip",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {}
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                "policyDefinitionReferenceId": "Deny-AppGw-Without-Waf",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appGwWaf')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
                "policyDefinitionReferenceId": "Deny-Subnet-Without-Udr",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('subnetUdr')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
                "policyDefinitionReferenceId": "Deny-Subnet-Without-NSG",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('subnetNsg')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints",
                "policyDefinitionReferenceId": "Deny-Subnet-with-Service-Endpoints",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('subnetServiceEndpoint')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
                "policyDefinitionReferenceId": "Deny-Mgmt-From-Internet",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('denyMgmtFromInternet')]"
                    },
                    "ports": {
                        "value": "[[parameters('denyMgmtFromInternetPorts')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls",
                "policyDefinitionReferenceId": "Deny-AppGw-Without-Tls",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appGwTlsVersion')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR",
                "policyDefinitionReferenceId": "Modify-Udr",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifyUdr')]"
                    },
                    "nextHopIpAddress": {
                        "value": "[[parameters('modifyUdrNextHopIpAddress')]"
                    },
                    "nextHopType": {
                        "value": "[[parameters('modifyUdrNextHopType')]"
                    },
                    "addressPrefix": {
                        "value": "[[parameters('modifyUdrAddressPrefix')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG",
                "policyDefinitionReferenceId": "Modify-Nsg",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifyNsg')]"
                    },
                    "nsgRuleName": {
                        "value": "[[parameters('modifyNsgRuleName')]"
                    },
                    "nsgRulePriority": {
                        "value": "[[parameters('modifyNsgRulePriority')]"
                    },
                    "nsgRuleDirection": {
                        "value": "[[parameters('modifyNsgRuleDirection')]"
                    },
                    "nsgRuleAccess": {
                        "value": "[[parameters('modifyNsgRuleAccess')]"
                    },
                    "nsgRuleProtocol": {
                        "value": "[[parameters('modifyNsgRuleProtocol')]"
                    },
                    "nsgRuleSourceAddressPrefix": {
                        "value": "[[parameters('modifyNsgRuleSourceAddressPrefix')]"
                    },
                    "nsgRuleSourcePortRange": {
                        "value": "[[parameters('modifyNsgRuleSourcePortRange')]"
                    },
                    "nsgRuleDestinationAddressPrefix": {
                        "value": "[[parameters('modifyNsgRuleDestinationAddressPrefix')]"
                    },
                    "nsgRuleDestinationPortRange": {
                        "value": "[[parameters('modifyNsgRuleDestinationPortRange')]"
                    },
                    "nsgRuleDescription": {
                        "value": "[[parameters('modifyNsgRuleDescription')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-Network_20250326",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Network and Networking services",
        "description": "This policy initiative is a group of policies that ensures Network and Networking services are compliant per regulated Landing Zones.",
        "metadata": {
            "version": "2.0.0",
            "category": "Network",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "replacesPolicy": "Enforce-Guardrails-Network",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "subnetUdr": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "subnetNsg": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "subnetServiceEndpoint": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appGwWaf": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "vnetModifyDdos": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Audit",
                    "Modify",
                    "Disabled"
                ]
            },
            "ddosPlanResourceId": {
                "type": "string",
                "defaultValue": ""
            },
            "wafMode": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "wafModeRequirement": {
                "type": "string",
                "defaultValue": "Prevention"
            },
            "wafFwRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "wafModeAppGw": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "wafModeAppGwRequirement": {
                "type": "string",
                "defaultValue": "Prevention"
            },
            "denyMgmtFromInternet": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "denyMgmtFromInternetPorts": {
                "type": "Array",
                "metadata": {
                    "displayName": "Ports",
                    "description": "Ports to be blocked"
                },
                "defaultValue": [
                    "22",
                    "3389"
                ]
            },
            "wafAfdEnabled": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "vpnAzureAD": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "appGwTlsVersion": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "modifyUdr": {
                "type": "string",
                "defaultValue": "Disabled"
            },
            "modifyUdrNextHopIpAddress": {
                "type": "string",
                "defaultValue": ""
            },
            "modifyUdrNextHopType": {
                "type": "string",
                "defaultValue": "None"
            },
            "modifyUdrAddressPrefix": {
                "type": "string",
                "defaultValue": "0.0.0.0/0"
            },
            "modifyNsg": {
                "type": "string",
                "defaultValue": "Disabled",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "modifyNsgRuleName": {
                "type": "string",
                "defaultValue": "DenyAnyInternetOutbound"
            },
            "modifyNsgRulePriority": {
                "type": "integer",
                "defaultValue": 1000
            },
            "modifyNsgRuleDirection": {
                "type": "string",
                "defaultValue": "Outbound"
            },
            "modifyNsgRuleAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Allow",
                    "Deny"
                ]
            },
            "modifyNsgRuleProtocol": {
                "type": "string",
                "defaultValue": "*"
            },
            "modifyNsgRuleSourceAddressPrefix": {
                "type": "string",
                "defaultValue": "*"
            },
            "modifyNsgRuleSourcePortRange": {
                "type": "string",
                "defaultValue": "*"
            },
            "modifyNsgRuleDestinationAddressPrefix": {
                "type": "string",
                "defaultValue": "Internet"
            },
            "modifyNsgRuleDestinationPortRange": {
                "type": "string",
                "defaultValue": "*"
            },
            "modifyNsgRuleDescription": {
                "type": "string",
                "defaultValue": "Deny any outbound traffic to the Internet"
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010",
                "policyDefinitionReferenceId": "Deny-Nsg-GW-subnet",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {}
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
                "policyDefinitionReferenceId": "Deny-VPN-AzureAD",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('vpnAzureAD')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
                "policyDefinitionReferenceId": "Deny-Waf-Afd-Enabled",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('wafAfdEnabled')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12430be1-6cc8-4527-a9a8-e3d38f250096",
                "policyDefinitionReferenceId": "Deny-Waf-AppGw-mode",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('wafModeAppGw')]"
                    },
                    "modeRequirement": {
                        "value": "[[parameters('wafModeAppGwRequirement')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                "policyDefinitionReferenceId": "Deny-Waf-Fw-rules",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('wafFwRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/425bea59-a659-4cbb-8d31-34499bd030b8",
                "policyDefinitionReferenceId": "Deny-Waf-mode",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('wafMode')]"
                    },
                    "modeRequirement": {
                        "value": "[[parameters('wafModeRequirement')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
                "policyDefinitionReferenceId": "Modify-vNet-DDoS",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('vnetModifyDdos')]"
                    },
                    "ddosPlan": {
                        "value": "[[parameters('ddosPlanResourceId')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
                "policyDefinitionReferenceId": "Deny-Ip-Forwarding",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {}
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
                "policyDefinitionReferenceId": "Deny-vNic-Pip",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {}
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                "policyDefinitionReferenceId": "Deny-AppGw-Without-Waf",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appGwWaf')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
                "policyDefinitionReferenceId": "Deny-Subnet-Without-Udr",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('subnetUdr')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
                "policyDefinitionReferenceId": "Deny-Subnet-Without-NSG",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('subnetNsg')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints",
                "policyDefinitionReferenceId": "Deny-Subnet-with-Service-Endpoints",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('subnetServiceEndpoint')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
                "policyDefinitionReferenceId": "Deny-Mgmt-From-Internet",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('denyMgmtFromInternet')]"
                    },
                    "ports": {
                        "value": "[[parameters('denyMgmtFromInternetPorts')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls",
                "policyDefinitionReferenceId": "Deny-AppGw-Without-Tls",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('appGwTlsVersion')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR",
                "policyDefinitionReferenceId": "Modify-Udr",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifyUdr')]"
                    },
                    "nextHopIpAddress": {
                        "value": "[[parameters('modifyUdrNextHopIpAddress')]"
                    },
                    "nextHopType": {
                        "value": "[[parameters('modifyUdrNextHopType')]"
                    },
                    "addressPrefix": {
                        "value": "[[parameters('modifyUdrAddressPrefix')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG",
                "policyDefinitionReferenceId": "Modify-Nsg",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifyNsg')]"
                    },
                    "nsgRuleName": {
                        "value": "[[parameters('modifyNsgRuleName')]"
                    },
                    "nsgRulePriority": {
                        "value": "[[parameters('modifyNsgRulePriority')]"
                    },
                    "nsgRuleDirection": {
                        "value": "[[parameters('modifyNsgRuleDirection')]"
                    },
                    "nsgRuleAccess": {
                        "value": "[[parameters('modifyNsgRuleAccess')]"
                    },
                    "nsgRuleProtocol": {
                        "value": "[[parameters('modifyNsgRuleProtocol')]"
                    },
                    "nsgRuleSourceAddressPrefix": {
                        "value": "[[parameters('modifyNsgRuleSourceAddressPrefix')]"
                    },
                    "nsgRuleSourcePortRange": {
                        "value": "[[parameters('modifyNsgRuleSourcePortRange')]"
                    },
                    "nsgRuleDestinationAddressPrefix": {
                        "value": "[[parameters('modifyNsgRuleDestinationAddressPrefix')]"
                    },
                    "nsgRuleDestinationPortRange": {
                        "value": "[[parameters('modifyNsgRuleDestinationPortRange')]"
                    },
                    "nsgRuleDescription": {
                        "value": "[[parameters('modifyNsgRuleDescription')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
}
,
{
    "name": "Enforce-Guardrails-OpenAI",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Open AI (Cognitive Service)",
        "description": "This policy initiative is a group of policies that ensures Open AI (Cognitive Service) is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.2.0",
            "category": "Cognitive Services",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "cognitiveServicesOutboundNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveServicesNetworkAcls": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveServicesModifyDisableLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "cognitiveServicesDisableLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveServicesCustomerStorage": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "cognitiveServicesManagedIdentity": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "azureAiNetworkAccess": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "azureAiPrivateLink": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "azureAiDisableLocalKey": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "azureAiDisableLocalKey2": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "azureAiDiagSettings": {
                "type": "string",
                "defaultValue": "AuditIfNotExists",
                "allowedValues": [
                    "AuditIfNotExists",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-RestrictOutboundNetworkAccess",
                "policyDefinitionReferenceId": "Deny-OpenAi-OutboundNetworkAccess",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesOutboundNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-NetworkAcls",
                "policyDefinitionReferenceId": "Deny-OpenAi-NetworkAcls",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesNetworkAcls')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe3fd216-4f83-4fc1-8984-2bbec80a3418",
                "policyDefinitionReferenceId": "Deny-Cognitive-Services-Managed-Identity",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesManagedIdentity')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/71ef260a-8f18-47b7-abcb-62d0673d94dc",
                "policyDefinitionReferenceId": "Deny-Cognitive-Services-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesDisableLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/46aa9b05-0e60-4eae-a88b-1e9d374fa515",
                "policyDefinitionReferenceId": "Deny-Cognitive-Services-Cust-Storage",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesCustomerStorage')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/14de9e63-1b31-492e-a5a3-c3f7fd57f555",
                "policyDefinitionReferenceId": "Modify-Cognitive-Services-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('cognitiveServicesModifyDisableLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
                "policyDefinitionReferenceId": "Deny-AzureAI-Network-Access",
                "definitionVersion": "3.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('azureAiNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6759c02-b87f-42b7-892e-71b3f471d782",
                "policyDefinitionReferenceId": "Audit-AzureAI-Private-Link",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('azureAiPrivateLink')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d45520cb-31ca-44ba-8da2-fcf914608544",
                "policyDefinitionReferenceId": "Dine-AzureAI-Local-Key",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('azureAiDisableLocalKey')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55eff01b-f2bd-4c32-9203-db285f709d30",
                "policyDefinitionReferenceId": "Dine-AzureAI-Local-Key2",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('azureAiDisableLocalKey2')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b4d1c4e-934c-4703-944c-27c82c06bebb",
                "policyDefinitionReferenceId": "Aine-AzureAI-Diag-Settings",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('azureAiDiagSettings')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-PostgreSQL",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for PostgreSQL",
        "description": "This policy initiative is a group of policies that ensures PostgreSQL is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "PostgreSQL",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "postgreSqlAdvThreatProtection": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3",
                "policyDefinitionReferenceId": "Dine-PostgreSql-Adv-Threat-Protection",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('postgreSqlAdvThreatProtection')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-SQL",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for SQL and SQL Managed Instance",
        "description": "This policy initiative is a group of policies that ensures SQL and SQL Managed Instance is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "SQL",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "sqlManagedAadOnly": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "sqlAadOnly": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "sqlManagedDefender": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "modifySqlPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c5a62eb0-c65a-4220-8a4d-f70dd4ca95dd",
                "policyDefinitionReferenceId": "Dine-Sql-Managed-Defender",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('sqlManagedDefender')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
                "policyDefinitionReferenceId": "Deny-Sql-Aad-Only",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('sqlAadOnly')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
                "policyDefinitionReferenceId": "Deny-Sql-Managed-Aad-Only",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('sqlManagedAadOnly')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6",
                "policyDefinitionReferenceId": "Dine-Sql-Adv-Data",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {}
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/28b0b1e5-17ba-4963-a7a4-5a1ab4400a0b",
                "policyDefinitionReferenceId": "Modify-Sql-PublicNetworkAccess",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifySqlPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-ServiceBus",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Service Bus",
        "description": "This policy initiative is a group of policies that ensures Service Bus is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Service Bus",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "serviceBusModifyDisableLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "serviceBusDenyDisabledLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "serviceBusDoubleEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "serviceBusAuthzRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee",
                "policyDefinitionReferenceId": "Deny-Sb-Authz-Rules",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('serviceBusAuthzRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ebaf4f25-a4e8-415f-86a8-42d9155bef0b",
                "policyDefinitionReferenceId": "Deny-Sb-Encryption",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('serviceBusDoubleEncryption')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cfb11c26-f069-4c14-8e36-56c394dae5af",
                "policyDefinitionReferenceId": "Deny-Sb-LocalAuth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('serviceBusDenyDisabledLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/910711a6-8aa2-4f15-ae62-1e5b2ed3ef9e",
                "policyDefinitionReferenceId": "Modify-Sb-LocalAuth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('serviceBusModifyDisableLocalAuth')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-Storage",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Storage Account",
        "description": "This policy initiative is a group of policies that ensures Storage is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Storage",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "storageKeysExpiration": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountNetworkRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountRestrictNetworkRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageThreatProtection": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "storageClassicToArm": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsInfraEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountSharedKey": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsCrossTenant": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsDoubleEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsCopyScope": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAccountsAllowedCopyScope": {
                "type": "string",
                "defaultValue": "AAD"
            },
            "storageServicesEncryption": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageLocalUser": {
                "type": "string",
                "defaultValue": "Disabled",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageSftp": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageNetworkAclsBypass": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageAllowedNetworkAclsBypass": {
                "type": "array",
                "defaultValue": [
                    "None"
                ]
            },
            "storageResourceAccessRulesTenantId": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageResourceAccessRulesResourceId": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageNetworkAclsVirtualNetworkRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageContainerDeleteRetentionPolicy": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "storageMinContainerDeleteRetentionInDays": {
                "type": "Integer",
                "defaultValue": 7
            },
            "storageCorsRules": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "modifyStorageFileSyncPublicEndpoint": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "modifyStorageAccountPublicEndpoint": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "storageAccountsModifyDisablePublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CopyScope",
                "policyDefinitionReferenceId": "Deny-Storage-CopyScope",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsCopyScope')]"
                    },
                    "allowedCopyScope": {
                        "value": "[[parameters('storageAccountsAllowedCopyScope')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ServicesEncryption",
                "policyDefinitionReferenceId": "Deny-Storage-ServicesEncryption",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageServicesEncryption')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-LocalUser",
                "policyDefinitionReferenceId": "Deny-Storage-LocalUser",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageLocalUser')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP",
                "policyDefinitionReferenceId": "Deny-Storage-SFTP",

                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageSftp')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsBypass",
                "policyDefinitionReferenceId": "Deny-Storage-NetworkAclsBypass",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageNetworkAclsBypass')]"
                    },
                    "allowedBypassOptions": {
                        "value": "[[parameters('storageAllowedNetworkAclsBypass')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesTenantId",
                "policyDefinitionReferenceId": "Deny-Storage-ResourceAccessRulesTenantId",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageResourceAccessRulesTenantId')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesResourceId",
                "policyDefinitionReferenceId": "Deny-Storage-ResourceAccessRulesResourceId",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageResourceAccessRulesResourceId')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsVirtualNetworkRules",
                "policyDefinitionReferenceId": "Deny-Storage-NetworkAclsVirtualNetworkRules",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageNetworkAclsVirtualNetworkRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ContainerDeleteRetentionPolicy",
                "policyDefinitionReferenceId": "Deny-Storage-ContainerDeleteRetentionPolicy",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageContainerDeleteRetentionPolicy')]"
                    },
                    "minContainerDeleteRetentionInDays": {
                        "value": "[[parameters('storageMinContainerDeleteRetentionInDays')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CorsRules",
                "policyDefinitionReferenceId": "Deny-Storage-CorsRules",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageCorsRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bfecdea6-31c4-4045-ad42-71b9dc87247d",
                "policyDefinitionReferenceId": "Deny-Storage-Account-Encryption",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsDoubleEncryption')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/92a89a79-6c52-4a7e-a03f-61306fc49312",
                "policyDefinitionReferenceId": "Deny-Storage-Cross-Tenant",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsCrossTenant')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
                "policyDefinitionReferenceId": "Deny-Storage-Shared-Key",
                "definitionVersion": "2.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountSharedKey')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4733ea7b-a883-42fe-8cac-97454c2a9e4a",
                "policyDefinitionReferenceId": "Deny-Storage-Infra-Encryption",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsInfraEncryption')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606",
                "policyDefinitionReferenceId": "Deny-Storage-Classic",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageClassicToArm')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c",
                "policyDefinitionReferenceId": "Dine-Storage-Threat-Protection",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageThreatProtection')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
                "policyDefinitionReferenceId": "Deny-Storage-Restrict-NetworkRules",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountRestrictNetworkRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
                "policyDefinitionReferenceId": "Deny-Storage-NetworkRules",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountNetworkRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/044985bb-afe1-42cd-8a36-9d5d42424537",
                "policyDefinitionReferenceId": "Deny-Storage-Account-Keys-Expire",
                "definitionVersion": "3.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageKeysExpiration')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e07b2e9-6cd9-4c40-9ccb-52817b95133b",
                "policyDefinitionReferenceId": "Modify-Storage-FileSync-PublicEndpoint",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifyStorageFileSyncPublicEndpoint')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b",
                "policyDefinitionReferenceId": "Modify-Blob-Storage-Account-PublicEndpoint",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('modifyStorageAccountPublicEndpoint')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a06d0189-92e8-4dba-b0c4-08d7669fce7d",
                "policyDefinitionReferenceId": "Modify-Storage-Account-PublicEndpoint",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('storageAccountsModifyDisablePublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
}
,
{
    "name": "Enforce-Guardrails-Synapse",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Synapse workspaces",
        "description": "This policy initiative is a group of policies that ensures Synapse workspaces is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.2.0",
            "category": "Synapse",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "synapseLocalAuth": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "synapseManagedVnet": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "synapseDataTraffic": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "synapseTenants": {
                "type": "string",
                "defaultValue": "Deny",
                "allowedValues": [
                    "Audit",
                    "Deny",
                    "Disabled"
                ]
            },
            "synapseAllowedTenantIds": {
                "type": "array",
                "defaultValue": [
                    "[[subscription().tenantId]"
                ]
            },
            "synapseFwRules": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": [
                    "Audit",
                    "Disabled"
                ]
            },
            "synapseModifyLocalAuth": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "synapseDefender": {
                "type": "string",
                "defaultValue": "DeployIfNotExists",
                "allowedValues": [
                    "DeployIfNotExists",
                    "Disabled"
                ]
            },
            "synapseModifyTlsVersion": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "synapseModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/951c1558-50a5-4ca3-abb6-a93e3e2367a6",
                "policyDefinitionReferenceId": "Dine-Synapse-Defender",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseDefender')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c3624673-d2ff-48e0-b28c-5de1c6767c3c",
                "policyDefinitionReferenceId": "Modify-Synapse-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseModifyLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/56fd377d-098c-4f02-8406-81eb055902b8",
                "policyDefinitionReferenceId": "Deny-Synapse-Fw-Rules",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseFwRules')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3a003702-13d2-4679-941b-937e58c443f0",
                "policyDefinitionReferenceId": "Deny-Synapse-Tenant-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseTenants')]"
                    },
                    "allowedTenantIds": {
                        "value": "[[parameters('synapseAllowedTenantIds')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3484ce98-c0c5-4c83-994b-c5ac24785218",
                "policyDefinitionReferenceId": "Deny-Synapse-Data-Traffic",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseDataTraffic')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d9dbfa3-927b-4cf0-9d0f-08747f971650",
                "policyDefinitionReferenceId": "Deny-Synapse-Managed-Vnet",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseManagedVnet')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8",
                "policyDefinitionReferenceId": "Deny-Synapse-Local-Auth",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseLocalAuth')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8b5c654c-fb07-471b-aa8f-15fea733f140",
                "policyDefinitionReferenceId": "Modify-Synapse-Tls-Version",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseModifyTlsVersion')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5c8cad01-ef30-4891-b230-652dadb4876a",
                "policyDefinitionReferenceId": "Modify-Synapse-Public-Network-Access",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('synapseModifyPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
},
{
    "name": "Enforce-Guardrails-VirtualDesktop",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-04-01",
    "scope": null,
    "properties": {
        "policyType": "Custom",
        "displayName": "Enforce recommended guardrails for Virtual Desktop",
        "description": "This policy initiative is a group of policies that ensures Virtual Desktop is compliant per regulated Landing Zones.",
        "metadata": {
            "version": "1.1.0",
            "category": "Desktop Virtualization",
            "source": "https://github.com/Azure/Enterprise-Scale/",
            "alzCloudEnvironments": [
                "AzureCloud",
                "AzureChinaCloud",
                "AzureUSGovernment"
            ]
        },
        "parameters": {
            "avdWorkspaceModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            },
            "avdHostPoolModifyPublicNetworkAccess": {
                "type": "string",
                "defaultValue": "Modify",
                "allowedValues": [
                    "Modify",
                    "Disabled"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ce6ebf1d-0b94-4df9-9257-d8cacc238b4f",
                "policyDefinitionReferenceId": "Modify-Workspace-PublicNetworkAccess",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('avdWorkspaceModifyPublicNetworkAccess')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a0913ff-51e7-47b8-97bb-ea17127f7c8d",
                "policyDefinitionReferenceId": "Modify-Hostpool-PublicNetworkAccess",
                "definitionVersion": "1.*.*",
                "groupNames": [],
                "parameters": {
                    "effect": {
                        "value": "[[parameters('avdHostPoolModifyPublicNetworkAccess')]"
                    }
                }
            }
        ],
        "policyDefinitionGroups": null
    }
}
]
